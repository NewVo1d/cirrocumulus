(window.webpackJsonpcirrocumulus=window.webpackJsonpcirrocumulus||[]).push([[0],{146:function(e,t,a){e.exports=a(172)},172:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(12),i=a(27),o=a(47),s=a(108),c=a(31),u=a(59),d=a(230),p=a(209),h=a(104),m=a(14),f=a(18),g=a(15),y=a(16),v=a(121),b=function(e){function t(){var e;Object(m.a)(this,t);for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return Object(f.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(n)))}return Object(y.a)(t,e),t}(Object(v.a)(Error)),E=a(17),O=a(20),k=a(65),w={Diverging:["interpolateBrBG","interpolatePRGn","interpolatePiYG","interpolatePuOr","interpolateRdBu","interpolateRdGy","interpolateRdYlBu","interpolateRdYlGn","interpolateSpectral"],"Sequential (Single Hue)":["interpolateBlues","interpolateGreens","interpolateGreys","interpolateOranges","interpolatePurples","interpolateReds"],"Sequential (Multi-Hue)":["interpolateViridis","interpolateInferno","interpolateMagma","interpolatePlasma","interpolateWarm","interpolateCool","interpolateCubehelixDefault","interpolateBuGn","interpolateBuPu","interpolateGnBu","interpolateOrRd","interpolatePuBuGn","interpolatePuBu","interpolatePuRd","interpolateRdPu","interpolateYlGnBu","interpolateYlGn","interpolateYlOrBr","interpolateYlOrRd"],Cyclical:["interpolateRainbow","interpolateSinebow"]},C=Object(O.a)(","),S=Object(O.a)(".1f");function j(e,t,a,n){var r=null,l=null;if(null!=e){var i=t.valueCounts.values[n],o=(e[i]||0)/t.valueCounts.counts[n];l=a(o),r=C(e[i]||0)+" / "+C(t.valueCounts.counts[n])+" ("+S(100*o)+"%)"}else l=a(t.valueCounts.counts[n]),r=C(t.valueCounts.counts[n]);return{width:l,text:r}}function M(e,t,a){var n=[Number.MAX_VALUE,-Number.MAX_VALUE];return t.forEach((function(t,r){var l;null!=e?l=e[t]/a[r]:l=a[r];n[0]=Math.min(n[0],l),n[1]=Math.max(n[1],l)})),Object(u.a)().domain(n).range([10,60])}function P(e){return e.startsWith("interpolate")||(e="interpolate"+e),k[e]}var A=function(){function e(){Object(m.a)(this,e)}return Object(E.a)(e,null,[{key:"createPlotConfig",value:function(){return{showLink:!0,responsive:!0,displaylogo:!1,modeBarButtonsToRemove:["hoverCompareCartesian","hoverClosestCartesian","toggleSpikelines"]}}},{key:"fixLegend",value:function(e){requestAnimationFrame((function(){if(e){var t=e.querySelectorAll(".scatterpts");t&&t.forEach((function(e){e.setAttribute("d","M6,0A6,6 0 1,1 0,-6A6,6 0 0,1 6,0Z"),e.style.opacity=1}))}}))}},{key:"createAxis",value:function(e){return e.embedding?{showbackground:!1,autorange:!0,showgrid:!1,zeroline:!1,showline:!1,autotick:!1,ticks:"",showticklabels:!1,title:""}:{showbackground:!1,autorange:!0,showgrid:!1,zeroline:!1,showline:!1,title:""}}},{key:"createPlotLayout",value:function(t){var a=t.legend||0,n=Math.floor(Math.min(window.screen.availWidth-220,.95*window.screen.availHeight)),r={hovermode:"closest",dragmode:"select",title:{text:t.title,font:{size:12}},width:n+a,height:n,margin:{l:t.embedding?0:50,b:t.embedding?0:50,r:a+(t.embedding?0:100),t:t.title?22:0,autoexpand:!0},legend:{yanchor:"top"},autosize:!t.embedding,displaylogo:!1,showlegend:t.legend>0};return t.is3d?r.scene={xaxis:e.createAxis(t),yaxis:e.createAxis(t),zaxis:e.createAxis(t)}:(r.xaxis=e.createAxis(t),r.yaxis=e.createAxis(t)),r}}]),e}(),x="/api",_=["email","profile","https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/contacts.readonly","https://www.googleapis.com/auth/devstorage.full_control"],D="SET_SERVER_INFO",T="ADD_DATASET",B="DELETE_DATASET",I="UPDATE_DATASET",L="SET_MARKER_SIZE",N="SET_MARKER_OPACITY",U="SET_UNSELECTED_MARKER_OPACITY",R="SET_SELECTED_POINTS",V="SET_SELECTED_VALUE_COUNTS",z="SET_FEATURES",G="SET_GROUP_BY",F="SET_SELECTED_EMBEDDING",W="SET_NUMBER_OF_BINS",q="SET_BIN_VALUES",K="SET_BIN_SUMMARY",H="SET_MESSAGE",X="SET_INTERPOLATOR",Y="SET_EMAIL",J="SET_USER",Z="SET_DATASET",Q="SET_DIALOG",$="EDIT_DATASET_DIALOG",ee="IMPORT_DATASET_DIALOG",te="DELETE_DATASET_DIALOG",ae="SET_DATASET_CHOICES",ne="RESTORE_VIEW",re="SET_DOT_PLOT_DATA",le="SET_EMBEDDING_DATA",ie="SET_LOADING",oe="LOADING_APP",se="SET_NUMBER_OF_BINS_UI",ce="SET_MARKER_SIZE_UI",ue="SET_MARKER_OPACITY_UI",de="SET_UNSELECTED_MARKER_OPACITY_UI",pe=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],he=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];function me(){return function(e,t){fetch(x+"/user",{headers:{Authorization:"Bearer "+Oe(),"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){return e({type:J,payload:t})}))}}function fe(){return function(e,t){window.gapi.auth2.getAuthInstance().signOut().then((function(){e({type:Y,payload:null}),e(Pe(null))}))}}function ge(e){return{type:V,payload:e}}function ye(e,t,a){var n=a().dataset.id,r=a().features,l=a().groupBy,i=a().embeddings;if(0===i.length||0===e.length)return Promise.resolve({});var o=[x+"/selected_value_counts?id="+n];return o.push("&embedding="+i[0]),r.forEach((function(e){return o.push("&key="+e)})),l.forEach((function(e){return o.push("&key="+e)})),e.forEach((function(e){return o.push("&p="+e)})),fetch(o.join(""),{headers:{Authorization:"Bearer "+Oe()}}).then((function(e){return e.json()})).then((function(e){return t(ge(e))}))}function ve(e){var t=null==e?[]:e.points[0].data.selectedpoints;return function(e,a){e(function(e){return{type:R,payload:e}}(t)),0===t.length?e(ge({count:0,categories:{}})):ye(t,e,a)}}function be(){return function(e,t){var a=window.location.search.substring(3);if(0!==a.length){var n;try{n=JSON.parse(window.decodeURIComponent(a))}catch(l){return e(Ce("Unable to restore saved view."))}if(null!=n.dataset){if(null!=n.colorScheme){var r=P(n.colorScheme);null!=r&&(n.colorScheme={name:n.colorScheme,value:r})}e(De(n.dataset)).then((function(){return e({type:ne,payload:n})})).then((function(){return e(Te({embedding:!0,dotPlot:!0,clear:!0}))})).catch((function(t){console.log(t),e(Ce("Unable to restore saved view."))}))}}}}function Ee(e){return function(t,a){if(window.gapi.auth2.getAuthInstance().isSignedIn.get()){var n=window.gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile().getEmail();t(Ae(n)),t(me()),t(Ie()).then((function(){e&&t(be())}))}}}function Oe(){return"undefined"!==typeof window.gapi?window.gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().id_token:""}function ke(e){return function(t,a){var n=e.readers,r=e.name,l=e.url;if(""!=r&&""!==l){l.substring("gs://".length).indexOf("/");var i=null!=e.dataset;t(je(!0));var o=a().serverInfo.email,s=!i||l!==e.dataset.url;Promise.resolve({ok:!0}).then((function(e){})).then((function(){return fetch(x+"/dataset",{body:JSON.stringify({id:null!=e.dataset?e.dataset.id:null,url:l,name:r,readers:n}),method:i?"PUT":"POST",headers:{Authorization:"Bearer "+Oe()}})})).then((function(e){return e.json()})).then((function(e){i?(t(function(e){return{type:I,payload:e}}({name:r,id:e.id,owner:!0})),t(Ce(s?"Please ensure that "+o+' is a "Storage Object Viewer"':"Dataset updated"))):(t(function(e){return{type:T,payload:e}}({name:r,id:e.id,owner:!0})),t(Ce(s?"Please ensure that "+o+' is a "Storage Object Viewer"':"Dataset created")))})).finally((function(){t(je(!1)),t(Se(null))})).catch((function(e){Be(t,e)}))}}}function we(e){return function(t,a){t(je(!0)),fetch(x+"/dataset",{body:JSON.stringify({id:e.dataset.id}),method:"DELETE",headers:{Authorization:"Bearer "+Oe()}}).then((function(){t(function(e){return{type:B,payload:e}}({id:e.dataset.id})),t(Ce("Dataset deleted"))})).finally((function(){t(je(!1)),t(Se(null))})).catch((function(e){Be(t,e,"Unable to delete dataset. Please try again.")}))}}function Ce(e){return{type:H,payload:e}}function Se(e){return{type:Q,payload:e}}function je(e){return{type:ie,payload:e}}function Me(e){return{type:oe,payload:e}}function Pe(e){return{type:Z,payload:e}}function Ae(e){return{type:Y,payload:e}}function xe(e){var t=e;return function(e,a){var n=a(),r=n.dataset.obsCat,l=n.features,i=n.groupBy,o=[],s=[];t.forEach((function(e){-1!==r.indexOf(e)?s.push(e):o.push(e)})),o.length!==l.length&&e(function(e){return function(t,a){var n=a().features;t({type:z,payload:e}),t(Te({embedding:!0,dotPlot:!0},(function(e){t({type:z,payload:n})})))}}(o)),s.length!==i.length&&e(function(e){return function(t,a){var n=a().groupBy;t({type:G,payload:e}),t(Te({embedding:!0,dotPlot:!0},(function(e){t({type:G,payload:n})})))}}(s))}}function _e(e){return function(t,a){var n=a().embeddings;t({type:F,payload:e}),t(Te({embedding:!0,clear:!0},(function(e){t({type:F,payload:n})})))}}function De(e){return function(t,a){for(var n=a().datasetChoices,r=null,l=0;l<n.length;l++)if(n[l].id===e){r=n[l];break}if(null!=r)return t(Pe({owner:r.owner,name:r.name,id:e,embeddings:[],features:[],obs:[],obsCat:[]})),t(je(!0)),fetch([x+"/schema?id="+e].join(""),{headers:{Authorization:"Bearer "+Oe()}}).then((function(e){return e.json()})).then((function(a){var n;return"1"===a.version&&(n={owner:r.owner,name:r.name,id:e,embeddings:a.embeddings,features:a.var,obsCat:a.obs_cat,nObs:a.n_obs,obs:a.obs}),t(Pe(n)),t((function(e,t){var a=t().dataset.embeddings.map((function(e){return e.name})),n={X_fle:1,X_umap:2,X_tsne:3,X_fitsne:4};a.sort((function(e,t){return(e=n[e]||Number.MAX_VALUE)-(t=n[t]||Number.MAX_VALUE)})),a.length>0&&e(_e([a[0]]))})),n})).finally((function(){t(je(!1))})).catch((function(e){Be(t,e,"Unable to retrieve dataset. Please try again.")}));t(Ce("Unable to find dataset"))}}function Te(e,t){return function(a,n){var r=n().features,l=n().groupBy;if(null!=n().dataset){a(je(!0));var i=n().dataset.id,o=n().dataset.obs,s=n().embeddings;e.embedding&&0===s.length&&(e.embedding=!1),e.dotPlot&&0===r.length&&(e.dotPlot=!1);var m=n().embeddingData;e.clear&&(m=[]);var f={},g=r.concat(l),y=[],v=n().markerSize,b=n().markerOpacity,E=n().unselectedMarkerOpacity;m.forEach((function(e){f[e.name]=!0;var t=-1!==g.indexOf(e.name);t&&(e.date=new Date,e.layout=A.createPlotLayout({embedding:!0,is3d:s[0].endsWith("3d"),legend:!1,title:e.name})),e.active=t}));var O=[x+"/slice?id="+i],k=[x+"/slice?id="+i],w=0;r.forEach((function(e){-1===o.indexOf(e)&&(k.push("&key="+e),w++),null!=f[e]||(y.push(e),O.push("&key="+e))})),(e.embedding||e.dotPlot)&&l.forEach((function(e){k.push("&key="+e),null!=f[e]||(y.push(e),O.push("&key="+e))}));var C=n().numberOfBins>0&&n().binValues;e.embedding&&C&&(O.push("&nbins="+n().numberOfBins),O.push("&reduce_function="+n().binSummary)),e.embedding&&s.length>0&&s.forEach((function(e){return O.push("&embedding="+e)}));var S=n().interpolator,j=n().selectedpoints,M=[];if(e.dotPlot){var P=null;P=w>0&&l.length>0?fetch(k.join(""),{headers:{Authorization:"Bearer "+Oe()}}).then((function(e){return e.json()})):Promise.resolve({stats:{}}),M.push(P),P.then((function(e){var t;a((t=e.dotplot||null,{type:re,payload:t}))}))}if(e.embedding){var _=ye(j,a,n),D=fetch(O.join(""),{headers:{Authorization:"Bearer "+Oe()}}).then((function(e){return e.json()}));M.push(D),M.push(_);var T=Object(u.a)().domain([0,255]).range([0,1]);D.then((function(e){var t,n=e.embedding.values,r=e.embedding.categories,l={},i=s[0].endsWith("3d");for(var o in l[s[0]+"_1"]=new Float32Array(n[s[0]+"_1"]),l[s[0]+"_2"]=new Float32Array(n[s[0]+"_2"]),i&&(l[s[0]+"_3"]=new Float32Array(n[s[0]+"_3"])),n)if(!(o in l)){var u=l[s[0]+"_1"],f=l[s[0]+"_2"],g=l[s[0]+"_3"],y=n[o],O=null!=r[o],k=null,w=null,C=null;if(O){var M=r[o].values;(k=Object(p.a)(M.length<=10?h.a:M.length<=20?pe:pe.concat(he)).domain(M)).valueCounts=r[o]}else{w=Number.MAX_VALUE,C=-Number.MAX_VALUE;for(var P=0,x=y.length;P<x;P++){var _=y[P];w=_<w?_:w,C=_>C?_:C}(k=Object(d.a)(S.value).domain([w,C])).valueCounts=e.embedding.obs[o]}for(var D=[],B=0,I=y.length;B<I;B++){var L=Object(c.e)(k(y[B]));D.push([T(L.r),T(L.g),T(L.b)])}var N={hoverinfo:"text",showlegend:!1,name:o,mode:"markers",type:i?"scatter3d":"scattergl",hoveron:"points",x:u,y:f,marker:{size:v,color:D,opacity:b,showscale:!1},unselected:{marker:{opacity:E}},selectedpoints:0===j.length?null:j,values:y,text:y};i&&(N.z=g),N=[N];var U=A.createPlotLayout({embedding:!0,is3d:i,legend:!1,title:o});m.push({date:new Date,active:!0,domain:O?null:[w,C],colorScale:k,continuous:!O,data:N,name:o,layout:U,isCategorical:O})}m.sort((function(e,t){return(e=e.name.toLowerCase())<(t=t.name.toLowerCase())?-1:1})),a((t=m.slice(0),{type:le,payload:t}))}))}Promise.all(M).finally((function(){a(je(!1))})).catch((function(e){Be(a,e,"Unable to retrieve data. Please try again."),t&&t(e)}))}}}function Be(e,t,a){if(console.log(t),401===t.status)return e(Ce("Your session has expired. Please login again.")),e(fe());null==a&&(a=t instanceof b?t.message:"An unexpected error occurred. Please try again."),e(Ce(new Error(a)))}function Ie(){return function(e,t){return e(je(!0)),fetch(x+"/datasets",{headers:{Authorization:"Bearer "+Oe()}}).then((function(e){return e.json()})).then((function(t){e({type:ae,payload:t})})).finally((function(){e(je(!1))})).catch((function(t){Be(e,t,"Unable to retrieve datasets. Please try again.")}))}}var Le=a(240),Ne=a(227),Ue=a(122),Re=a(232),Ve=a(228),ze=a(217),Ge=a(219),Fe=a(234),We=a(220),qe=a(233),Ke=a(223),He=a(231),Xe=a(58),Ye=a.n(Xe),Je=a(229),Ze=a(117),Qe=a.n(Ze),$e=a(118),et=a.n($e),tt=a(113),at=a.n(tt),nt=a(75),rt=a.n(nt),lt=a(115),it=a.n(lt),ot=a(116),st=a.n(ot),ct=a(210),ut=a(216),dt=a(215),pt=a(214),ht=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).handleClose=function(){a.props.handleCancel()},a.handleDelete=function(){a.setState({loading:!0}),a.props.handleDelete({dataset:a.props.dataset})},a.state={open:!0},a}return Object(y.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){return r.a.createElement(ct.a,{open:this.state.open,onClose:this.handleClose,"aria-labelledby":"delete-dataset-dialog-title",fullWidth:!0,maxWidth:"sm"},r.a.createElement(pt.a,{id:"delete-dataset-dialog-title"},"Delete Dataset"),r.a.createElement(dt.a,null,r.a.createElement("h3",null,"Are you sure you want to delete ",this.props.dataset.name,"?")),r.a.createElement(ut.a,null,r.a.createElement(ze.a,{disabled:this.state.loading,onClick:this.handleClose,color:"primary"},"Cancel"),r.a.createElement(ze.a,{disabled:this.state.loading,onClick:this.handleDelete,color:"primary"},"Delete ",r.a.createElement(rt.a,null))))}}]),t}(r.a.PureComponent),mt=Object(i.b)((function(e){return{dataset:e.dataset,email:e.email}}),(function(e){return{handleDelete:function(t){e(we(t))},handleCancel:function(t){e(Se(null))}}}))(ht),ft=a(77),gt=a.n(ft),yt=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).handleStart=function(e){},a.handleDrag=function(e,t){},a.handleStop=function(e){},a.ref=r.a.createRef(),a.backingScale=1,a}return Object(y.a)(t,e),Object(E.a)(t,[{key:"redraw",value:function(){var e=this.backingScale,t=this.ref.current.getContext("2d"),a=this.props.height,n=this.props.width;t.clearRect(0,0,n*e,a*e),t.scale(e,e);var r=this.props.scale;if(null!=r){var l=r.domain();if(l[0]!==l[1]){for(var i=l[0],o=this.props.nsteps||10,s=(l[1]-l[0])/o,c=t.createLinearGradient(0,0,n,20),d=Object(u.a)().range([0,1]).domain(l).clamp(!0),p=0;p<o;p++){p===o-1&&(i=l[1]);var h=d(i);if(!isNaN(h)){var m=r(i);c.addColorStop(h,m)}i+=s}if(t.fillStyle=c,t.fillRect(0,0,n,20),t.strokeStyle="LightGrey",t.strokeRect(0,0,n,20),this.props.label>0){var f=Object(O.a)(".1f");t.font="12px Helvetica",t.textBaseline="top",t.fillStyle="black",t.textAlign="left",t.fillText(f(l[0]),0,22),t.textAlign="right",t.fillText(f(l[1]),n,22)}t.setTransform(1,0,0,1,0,0)}}}},{key:"componentDidMount",value:function(){this.redraw()}},{key:"componentDidUpdate",value:function(e,t,a){this.redraw()}},{key:"render",value:function(){var e=1;"undefined"!==typeof window&&"devicePixelRatio"in window&&(e=window.devicePixelRatio),this.backingScale=e;var t=this.props.height,a=this.props.width,n={width:a,height:t,display:"block"};return this.props.style&&(n=Object.assign({},n,this.props.style)),r.a.createElement("canvas",{width:a*e,height:t*e,ref:this.ref,style:n})}}]),t}(r.a.PureComponent),vt=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).ref=r.a.createRef(),a.backingScale=1,a}return Object(y.a)(t,e),Object(E.a)(t,[{key:"redraw",value:function(){var e=this.backingScale,t=this.ref.current.getContext("2d"),a=this.props.height,n=this.props.width;t.clearRect(0,0,n*e,a*e),t.scale(e,e);var r=this.props.scale;if(null!=r){var l=r.domain(),i=l[0],o=this.props.nsteps||3,s=(l[1]-l[0])/o,c=Object(u.a)().range([25,n-25]).domain([0,o-1]).clamp(!0),d=Object(u.a)().range([2,10]).domain(l).clamp(!0),p=Object(O.a)(".0f");t.font="12px Helvetica",t.textBaseline="top",t.fillStyle="black",t.textAlign="center";for(var h=0;h<o;h++){h===o-1&&(i=l[1]);var m=c(h),f=d(i);t.beginPath(),t.arc(m,10,f,0,2*Math.PI),t.stroke(),t.fillText(p(100*i),m,22),i+=s}t.setTransform(1,0,0,1,0,0)}}},{key:"componentDidUpdate",value:function(e,t,a){this.redraw()}},{key:"componentDidMount",value:function(){this.redraw()}},{key:"render",value:function(){var e=1;"undefined"!==typeof window&&"devicePixelRatio"in window&&(e=window.devicePixelRatio),this.backingScale=e;var t=this.props.height,a=this.props.width,n={width:a,height:t};return this.props.style&&(n=Object.assign({},n,this.props.style)),r.a.createElement("canvas",{width:a*e,height:t*e,ref:this.ref,style:n})}}]),t}(r.a.PureComponent),bt=gt()(window.Plotly),Et=function(e){function t(){return Object(m.a)(this,t),Object(f.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){if(null==this.props.data)return r.a.createElement("div",null);var e=this.props.data,t=e.index||[""],a=Number.MAX_VALUE,n=-Number.MAX_VALUE,l=Number.MAX_VALUE,i=-Number.MAX_VALUE,o={};for(var s in e)if("index"!==s){var c=e[s],d=void 0,p=void 0,h=s.indexOf(","),m=s.substring(2,h-1),f=s.substring(h+3,s.length-2),g=o[m];void 0===g&&(g={},o[m]=g),"non_zero"===f?(d=l,p=i,g.fraction=c):"mean"===f?(d=a,p=n,g.summary=c):console.log("Unknown type: "+f+".");for(var y=0;y<c.length;y++)d=Math.min(d,c[y]),p=Math.max(p,c[y]);"non_zero"===f?(l=d,i=p):(a=d,n=p)}a===n&&n++,l===i&&(l=0,i=1);var v=Object(O.a)(".1f"),b=Object(u.a)().domain([a,n]).range(["blue","red"]),E=Object(u.a)().domain([l,i]).range([1,14]),k=[],w=[],C=[],S=[],j=[],M=[];for(var P in o){M.push(P);for(var x=o[P],_=x.summary,D=x.fraction,T=0;T<_.length;T++)w.push(b(_[T])),k.push(E(D[T])),S.push(P),C.push(t[T]),j.push("mean: "+v(_[T])+", % non-zero: "+v(100*D[T]))}var B=[{type:"scatter",x:C,y:S,text:j,mode:"markers",name:"",marker:{color:w,symbol:"circle",size:k}}],I=A.createPlotConfig(),L=A.createPlotLayout({embedding:!1});return L.xaxis.type="category",L.yaxis.type="category",L.height=100+16*M.length,L.width=Math.max(300,70+16*t.length),r.a.createElement("div",{style:{maxWidth:800,overflow:"auto",border:"1px solid LightGrey"}},r.a.createElement(bt,{data:B,embedding:L,config:I}),r.a.createElement(yt,{style:{display:"block"},width:300,label:!0,height:40,scale:b}),r.a.createElement(vt,{style:{display:"block"},width:150,label:!0,height:40,scale:E}))}}]),t}(r.a.PureComponent),Ot=Object(i.b)((function(e){return{data:e.dotPlotData}}),(function(e){return{}}))(Et),kt=a(235),wt=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).handleClose=function(){a.props.handleCancel()},a.handleSave=function(){var e=a.state.datasetName.trim(),t=a.state.url.trim();if(""!==e&&""!==t){a.setState({loading:!0});for(var n=a.state.readers.split(","),r=new Set,l=0;l<n.length;l++){var i=n[l].trim().toLowerCase();""!==i&&r.add(i)}var o=Array.from(r);a.props.handleSave({dataset:a.props.dataset,name:e,url:t,readers:o})}},a.onEmailChanged=function(e){a.setState({readers:e.target.value})},a.onUrlChanged=function(e){a.setState({url:e.target.value})},a.onDatasetNameChanged=function(e){a.setState({datasetName:e.target.value})},a.state={url:"",datasetName:null!=a.props.dataset?a.props.dataset.name:"",readers:"",loading:null!=a.props.dataset},a}return Object(y.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this;null!=this.props.dataset&&fetch(x+"/dataset?id="+this.props.dataset.id,{method:"GET",headers:{Authorization:"Bearer "+Oe()}}).then((function(e){return e.json()})).then((function(t){var a=[];for(var n in t.roles)"reader"===t[n]&&a.push(n);e.setState({datasetName:t.name,loading:!1,url:t.url,readers:a.join(", ")})})).catch((function(t){e.props.handleError("Unable to retrieve dataset details. Please try again."),e.props.handleCancel()}))}},{key:"render",value:function(){return r.a.createElement(ct.a,{open:!0,onClose:this.handleClose,"aria-labelledby":"edit-dataset-dialog-title",fullWidth:!0,maxWidth:"sm"},r.a.createElement(pt.a,{id:"edit-dataset-dialog-title"},null==this.props.dataset?"Import":"Edit"," Dataset"),r.a.createElement(dt.a,null,this.state.loading&&r.a.createElement(Ge.a,null),r.a.createElement(kt.a,{disabled:this.state.loading,required:!0,value:this.state.datasetName,onChange:this.onDatasetNameChanged,margin:"dense",label:"Dataset name",fullWidth:!0}),!this.state.loading&&r.a.createElement(kt.a,{required:!0,value:this.state.url,onChange:this.onUrlChanged,margin:"dense",helperText:"Please ensure that "+this.props.serverEmail+' has "Storage Object Viewer" permissions',label:"Dataset URL (e.g. gs://my_bucket/my_dataset.parquet)",fullWidth:!0}),!this.state.loading&&r.a.createElement(kt.a,{value:this.state.readers,onChange:this.onEmailChanged,margin:"dense",label:"Comma separated list of emails to share with",fullWidth:!0,multiline:!0})),r.a.createElement(ut.a,null,r.a.createElement(ze.a,{disabled:this.state.loading,onClick:this.handleClose,color:"primary"},"Cancel"),r.a.createElement(ze.a,{disabled:this.state.loading,onClick:this.handleSave,color:"primary"},"Save")))}}]),t}(r.a.PureComponent),Ct=Object(i.b)((function(e){return{dataset:e.dialog===$?e.dataset:null,serverEmail:e.serverInfo.email}}),(function(e){return{handleSave:function(t){e(ke(t))},handleCancel:function(t){e(Se(null))},handleError:function(t){e(Ce(t))}}}))(wt),St=function(e){function t(e){return Object(m.a)(this,t),Object(f.a)(this,Object(g.a)(t).call(this,e))}return Object(y.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){var e=this.props.scale,t=e.domain(),a=this.props.selectedValueCounts,n=null!=a.categories?a.categories[this.props.name]:null,l=M(n,e.valueCounts.values,e.valueCounts.counts);return r.a.createElement("div",{style:{display:"inline-block",padding:10,verticalAlign:"top"}},t.map((function(t,a){var i=j(n,e,l,a);return r.a.createElement("div",{key:t},r.a.createElement("div",{style:{display:"inline-block",width:i.width,height:10,background:e(t)}}),r.a.createElement("label",{style:{marginLeft:4}},t+" - "+i.text))})))}}]),t}(r.a.PureComponent),jt=(Object(O.a)(","),function(e){function t(){return Object(m.a)(this,t),Object(f.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){var e=this.props.style,t=this.props.scale,a=this.props.name,n=t.valueCounts.values,l=t.domain();l[0]===l[1]&&(n=[]);var i=this.props.selectedValueCounts,o=null!=i.categories?i.categories[a]:null;o&&(null!=o.True&&(o.true=o.True),null!=o.False&&(o.false=o.False));var s=M(o,t.valueCounts.values,t.valueCounts.counts);return r.a.createElement("div",{style:e},n.map((function(e,a){var n=e;1==n?n="expressed":0==n&&(n="not expressed");var l=j(o,t,s,a);return r.a.createElement("div",{key:e},r.a.createElement("div",{style:{display:"inline-block",width:l.width,height:10,background:"LightGrey"}}),r.a.createElement("label",{style:{marginLeft:4}},n+" - "+l.text))})),r.a.createElement(yt,{width:this.props.width,height:this.props.height,style:e,scale:t,label:this.props.label}))}}]),t}(r.a.PureComponent)),Mt=gt()(window.Plotly),Pt=function(e){function t(){return Object(m.a)(this,t),Object(f.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(E.a)(t,[{key:"getPlots",value:function(){var e=this;return this.props.data.filter((function(e){return e.active})).map((function(t){return r.a.createElement("div",{style:{display:"inline-block",border:"1px solid LightGrey"},key:t.name},r.a.createElement(Mt,{key:t.name,data:t.data,layout:t.layout,config:e.props.config,onDeselect:e.props.onDeselect,onSelected:e.props.onSelect}),t.continuous?r.a.createElement(jt,{style:{display:"block",marginLeft:"auto",marginRight:"auto"},width:300,label:!0,height:40,scale:t.colorScale,name:t.name,selectedValueCounts:e.props.selectedValueCounts}):r.a.createElement(St,{name:t.name,scale:t.colorScale,selectedValueCounts:e.props.selectedValueCounts}))}))}},{key:"render",value:function(){return this.getPlots()}}]),t}(r.a.PureComponent),At=Object(i.b)((function(e){return{data:e.embeddingData,config:e.plotConfig,selectedValueCounts:e.selectedValueCounts}}),(function(e){return{onSelect:function(t){e(ve(t))},onDeselect:function(){e(ve(null))},onZoom:function(){}}}))(Pt),xt=a(239),_t=a(222),Dt=a(226),Tt=a(237),Bt=a(225),It=a(89),Lt=a(123),Nt=a(238),Ut=a(218),Rt=a(90),Vt=a(6),zt=a(86),Gt=a(61),Ft=a(112),Wt=a.n(Ft),qt=a(110),Kt=a.n(qt),Ht=a(119);function Xt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Yt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Xt(a,!0).forEach((function(t){Object(It.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Xt(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Jt={display:"flex",alignItems:"center",justifyContent:"space-between"},Zt=function(e){return r.a.createElement("div",{style:Jt},r.a.createElement("span",null,e.label))};function Qt(e){var t=e.inputRef,a=Object(Lt.a)(e,["inputRef"]);return r.a.createElement("div",Object.assign({ref:t},a))}var $t={Control:function(e){return r.a.createElement(kt.a,Object.assign({fullWidth:!0,InputProps:{inputComponent:Qt,inputProps:Yt({className:e.selectProps.classes.input,inputRef:e.innerRef,children:e.children},e.innerProps)}},e.selectProps.textFieldProps))},Menu:function(e){return r.a.createElement(Rt.a,Object.assign({square:!0,className:e.selectProps.classes.paper},e.innerProps),e.children)},MultiValue:function(e){return r.a.createElement(Nt.a,{tabIndex:-1,label:e.children,className:Kt()(e.selectProps.classes.chip,Object(It.a)({},e.selectProps.classes.chipFocused,e.isFocused)),onDelete:e.removeProps.onClick,deleteIcon:r.a.createElement(Wt.a,e.removeProps)})},NoOptionsMessage:function(e){return r.a.createElement(Gt.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.noOptionsMessage},e.innerProps),e.children)},Option:function(e){return r.a.createElement(qe.a,Object.assign({buttonRef:e.innerRef,selected:e.isFocused,component:"div",style:{fontWeight:e.isSelected?500:400}},e.innerProps),e.children)},Placeholder:function(e){return r.a.createElement(Gt.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)},SingleValue:function(e){return r.a.createElement(Gt.a,Object.assign({className:e.selectProps.classes.singleValue},e.innerProps),e.children)},ValueContainer:function(e){return r.a.createElement("div",{className:e.selectProps.classes.valueContainer},e.children)}},ea=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(f.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).loadOptions=function(e,t){return t(a.filterOptions(e))},a.noOptionsMessage=function(){return"No matches"},a.onChange=function(e){a.props.isMulti?a.props.onChange(null==e||0===e.length?null:e.map((function(e){return e.value}))):a.props.onChange(e)},a.filterOptions=function(e){if(e){for(var t=1===(e=e.toLowerCase()).length?3:2===e.length?10:20,n=0,r=[],l=0,i=a.props.options.length;l<i;l++){var o=a.props.options[l],s={label:o.label,options:[]};r.push(s);for(var c=0,u=o.options.length;c<u;c++){var d=o.options[c];if(d.value.toLowerCase().startsWith(e)&&(n++,s.options.push(d),n===t))return r}}return r}return[]},a}return Object(y.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.theme,n={input:function(e){return Yt({},e,{color:a.palette.text.primary,"& input":{font:"inherit"}})}};return r.a.createElement("div",{className:t.root},r.a.createElement(Ut.a,null,r.a.createElement(Ht.a,{noOptionsMessage:this.noOptionsMessage,cacheOptions:!1,placeholder:"",loadOptions:this.loadOptions,classes:t,styles:n,textFieldProps:{label:this.props.label,helperText:this.props.helperText,InputLabelProps:{shrink:!0}},formatGroupLabel:Zt,components:$t,onChange:this.onChange,value:this.props.value,isMulti:this.props.isMulti,defaultOptions:this.props.defaultOptions})))}}]),t}(r.a.Component),ta=Object(Vt.a)((function(e){return{root:{flexGrow:1},input:{display:"flex",padding:0,maxWidth:"220px",height:"100%"},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden"},chip:{margin:"".concat(e.spacing(1)/2,"px ").concat(e.spacing(1)/4,"px")},chipFocused:{backgroundColor:Object(zt.emphasize)("light"===e.palette.type?e.palette.grey[300]:e.palette.grey[700],.08)},noOptionsMessage:{padding:"".concat(e.spacing(1),"px ").concat(2*e.spacing(1),"px")},singleValue:{fontSize:16},placeholder:{position:"absolute",left:2,fontSize:16},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0},divider:{height:2*e.spacing(1)}}}),{withTheme:!0})(ea),aa=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(f.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).handleInterpolatorChange=function(e){var t=e.target.value;a.props.handleInterpolator({name:t,value:P(t)})},a}return Object(y.a)(t,e),Object(E.a)(t,[{key:"getScale",value:function(e){return Object(d.a)(k[e]).domain([0,1])}},{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement(He.a,{input:r.a.createElement(We.a,{id:"color-scheme"}),className:t.select,onChange:this.handleInterpolatorChange,value:this.props.interpolator.name,multiple:!1},r.a.createElement(qe.a,{key:"Diverging",value:"Diverging",divider:!0,disabled:!0},"Diverging"),w.Diverging.map((function(t){return r.a.createElement(qe.a,{value:t,key:t},r.a.createElement(yt,{width:200,label:!1,height:24,scale:e.getScale(t)}))})),r.a.createElement(qe.a,{key:"Sequential (Single Hue)",value:"Sequential (Single Hue)",divider:!0,disabled:!0},"Sequential (Single Hue)"),w["Sequential (Single Hue)"].map((function(t){return r.a.createElement(qe.a,{value:t,key:t},r.a.createElement(yt,{width:200,label:!1,height:20,scale:e.getScale(t)}))})),r.a.createElement(qe.a,{key:"Sequential (Multi-Hue)",value:"Sequential (Multi-Hue)",divider:!0,disabled:!0},"Sequential (Multi-Hue)"),w["Sequential (Multi-Hue)"].map((function(t){return r.a.createElement(qe.a,{value:t,key:t},r.a.createElement(yt,{width:200,label:!1,height:20,scale:e.getScale(t)}))})),r.a.createElement(qe.a,{key:"Cyclical",value:"Cyclical",divider:!0,disabled:!0},"Cyclical"),w.Cyclical.map((function(t){return r.a.createElement(qe.a,{value:t,key:t},r.a.createElement(yt,{width:200,label:!1,height:20,scale:e.getScale(t)}))})))}}]),t}(r.a.PureComponent),na=Ye()((function(e){return{root:{display:"flex",flexWrap:"wrap","flex-direction":"column"},formControl:{display:"block",margin:e.spacing(1),minWidth:200},select:{minWidth:200}}}))(Object(i.b)((function(e){return{interpolator:e.interpolator}}),(function(e){return{handleInterpolator:function(t){e({type:X,payload:t})}}}))(aa)),ra=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(f.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(r)))).onMarkerSizeChange=function(e){a.props.handleMarkerSizeUI(e.target.value)},a.onMarkerSizeKeyPress=function(e){if("Enter"===e.key){var t=parseFloat(e.target.value);t>0&&a.props.handleMarkerSize(t)}},a.onMarkerOpacityChange=function(e){a.props.handleMarkerOpacityUI(e.target.value)},a.onMarkerOpacityKeyPress=function(e){if("Enter"===e.key){var t=parseFloat(e.target.value);t>0&&t<=1&&a.props.handleMarkerOpacity(t)}},a.onUnselectedMarkerOpacityChange=function(e){a.props.handleUnselectedMarkerOpacityUI(e.target.value)},a.onUnselectedMarkerOpacityKeyPress=function(e){if("Enter"===e.key){var t=parseFloat(e.target.value);t>0&&t<=1&&a.props.handleUnselectedMarkerOpacity(t)}},a.onNumberOfBinsChange=function(e){a.props.handleNumberOfBinsUI(e.target.value)},a.onNumberOfBinsKeyPress=function(e){if("Enter"===e.key){var t=parseInt(e.target.value);t>0&&a.props.handleNumberOfBins(t)}},a.onBinSummaryChange=function(e){a.props.handleBinSummary(e.target.value)},a.handleBinValuesChange=function(e){a.props.handleBinValues(e.target.checked)},a.handleViewChange=function(e){a.props.handleViewName(e.target.value)},a}return Object(y.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.selectedFeatures,n=e.selectedGroupBy,l=e.selectedEmbeddings,i=e.numberOfBins,o=e.markerSize,s=e.markerOpacity,c=e.unselectedMarkerOpacity,u=e.binValues,d=e.binSummary,p=e.dataset,h=null==p?[]:p.features,m=null==p?[]:p.embeddings,f=null==p?[]:p.obsCat,g=null==p?[]:p.obs,y=a.concat(n);y=y.map((function(e){return{label:e,value:e}}));var v=g.map((function(e){return{label:e,value:e}}));(v=v.concat(f.map((function(e){return{label:e,value:e,categorical:!0}})))).sort((function(e,t){return(e=e.label.toLowerCase())<(t=t.label.toLowerCase())?-1:e==t?0:1}));var b=[{label:"Annotations",options:v},{label:"Variables",options:h.map((function(e){return{label:e,value:e}}))}],E=[{label:"Annotations",options:v},{label:"Variables",options:[{isDisabled:!0,label:"Type to search",value:""}]}];return r.a.createElement("div",{className:t.root},r.a.createElement(_t.a,{className:t.formControl},r.a.createElement(Tt.a,{htmlFor:"view"},"Embedding"),r.a.createElement(He.a,{className:t.select,input:r.a.createElement(We.a,{id:"view"}),onChange:this.handleViewChange,value:0===l.length?"":l[0],multiple:!1},m.map((function(e){return r.a.createElement(qe.a,{key:e.name,value:e.name},r.a.createElement(Bt.a,{primary:e.name}))})))),r.a.createElement(_t.a,{className:t.formControl},r.a.createElement(ta,{label:"Features",options:b,defaultOptions:E,value:y,onChange:this.props.handleFeatures,isMulti:!0})),r.a.createElement(kt.a,{type:"number",step:"2",min:"0.1",max:"30",onKeyPress:this.onMarkerSizeKeyPress,onChange:this.onMarkerSizeChange,label:"Marker Size",className:t.formControl,value:o}),r.a.createElement(kt.a,{step:"0.1",type:"number",min:"0.01",max:"1",onKeyPress:this.onMarkerOpacityKeyPress,onChange:this.onMarkerOpacityChange,label:"Marker Opacity",className:t.formControl,value:s}),r.a.createElement(kt.a,{step:"0.1",type:"number",min:"0.01",max:"1",onKeyPress:this.onUnselectedMarkerOpacityKeyPress,onChange:this.onUnselectedMarkerOpacityChange,label:"Unselected Marker Opacity",className:t.formControl,value:c}),r.a.createElement(Dt.a,{control:r.a.createElement(xt.a,{checked:u,value:"binPlot",onChange:this.handleBinValuesChange}),label:"Bin Plot"}),r.a.createElement(_t.a,{className:t.formControl},r.a.createElement(Tt.a,{htmlFor:"color-scheme"},"Color Scheme"),r.a.createElement(na,null)),u&&r.a.createElement(kt.a,{max:"1000",min:"20",step:"100",onKeyPress:this.onNumberOfBinsKeyPress,value:i,onChange:this.onNumberOfBinsChange,label:"# Bins Per Axis",className:t.formControl}),u&&r.a.createElement(_t.a,{className:t.formControl},r.a.createElement(Tt.a,{htmlFor:"summary"},"Bin Summary"),r.a.createElement(He.a,{className:t.select,input:r.a.createElement(We.a,{id:"summary"}),onChange:this.onBinSummaryChange,value:d},[{value:"min",label:"Minimum"},{value:"max",label:"Maximum"},{value:"mean",label:"Mean"},{value:"sum",label:"Sum"}].map((function(e){return r.a.createElement(qe.a,{key:e.value,value:e.value},r.a.createElement(Bt.a,{primary:e.label}))})))))}}]),t}(r.a.PureComponent),la=Ye()((function(e){return{root:{display:"flex",flexWrap:"wrap","flex-direction":"column"},formControl:{display:"block",margin:e.spacing(1),minWidth:200},select:{minWidth:200}}}))(Object(i.b)((function(e){return{selectedFeatures:e.features,selectedGroupBy:e.groupBy,selectedEmbeddings:e.embeddings,numberOfBins:e.numberOfBinsUI,markerSize:e.markerSizeUI,markerOpacity:e.markerOpacityUI,unselectedMarkerOpacity:e.unselectedMarkerOpacityUI,binValues:e.binValues,binSummary:e.binSummary,dataset:e.dataset}}),(function(e,t){return{handleNumberOfBins:function(t){var a;e((a=t,function(e,t){if(t().numberOfBins!==a){var n=t().numberOfBins;e({type:W,payload:a}),e(Te({embedding:!0,clear:!0},(function(t){e({type:W,payload:n})})))}}))},handleNumberOfBinsUI:function(t){e({type:se,payload:t})},handleMarkerSize:function(t){e({type:L,payload:t})},handleMarkerSizeUI:function(t){e({type:ce,payload:t})},handleMarkerOpacity:function(t){e({type:N,payload:t})},handleMarkerOpacityUI:function(t){e({type:ue,payload:t})},handleUnselectedMarkerOpacity:function(t){e({type:U,payload:t})},handleUnselectedMarkerOpacityUI:function(t){e({type:de,payload:t})},handleBinSummary:function(t){var a;e((a=t,function(e,t){var n=t().binSummary;e({type:K,payload:a}),e(Te({embedding:!0,clear:!0},(function(t){e({type:K,payload:n})})))}))},handleBinValues:function(t){var a;e((a=t,function(e,t){var n=t().binValues;e(ve(null)),e({type:q,payload:a}),e(Te({embedding:!0,clear:!0},(function(t){e({type:q,payload:n})})))}))},handleViewName:function(t){e(_e(null==t?[]:[t]))},handleFeatures:function(t){e(xe(null==t?[]:t))}}}))(ra)),ia=5,oa=1,sa=.1,ca="mean",ua=500,da="Viridis",pa={name:da,value:P(da)};var ha=Object(o.c)({features:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case z:return t.payload;case Z:return[];case ne:return t.payload.features||[];default:return e}},groupBy:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case G:return t.payload;case Z:return[];case ne:return t.payload.groupBy||[];default:return e}},embeddings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case F:return t.payload;case Z:return[];case ne:return null!=t.payload.embeddings?t.payload.embeddings:e;default:return e}},numberOfBins:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ua,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case W:return t.payload;case Z:return ua;case ne:return null!=t.payload.numberOfBins?t.payload.numberOfBins:e;default:return e}},binSummary:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ca,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case K:return t.payload;case Z:return ca;case ne:return null!=t.payload.binSummary?t.payload.binSummary:e;default:return e}},email:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Y:return t.payload;default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case J:return t.payload;default:return e}},loadingApp:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case oe:return t.payload;default:return e}},dataset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Z:return t.payload;default:return e}},binValues:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case q:return t.payload;case Z:return!1;case ne:return null!=t.payload.binValues?t.payload.binValues:e;default:return e}},datasetChoices:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ae:return t.payload;case Y:return null==t.payload?[]:e;case T:return(e=e.concat([t.payload])).sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1})),e;case I:case B:for(var a=-1,n=0;n<e.length;n++)if(e[n].id===t.payload.id){a=n;break}return-1!==a?(t.type===I?e[a]=t.payload:e.splice(a,1),e.slice()):e;default:return e}},dialog:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Q:return t.payload;default:return e}},dotPlotData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case re:return t.payload;case Z:return null;default:return e}},embeddingData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case le:return t.payload;case L:return e.forEach((function(e){e.data.forEach((function(e){e.marker.size=t.payload})),e.data=e.data.slice()})),e.slice();case V:return e.slice();case R:return e.forEach((function(e){e.data.forEach((function(e){e.selectedpoints=t.payload})),e.data=e.data.slice()})),e.slice();case X:var a=Object(u.a)().domain([0,255]).range([0,1]);return e.forEach((function(e){if(e.continuous){var n=Object(d.a)(t.payload.value).domain(e.colorScale.domain());e.data.forEach((function(e){for(var t=[],r=0,l=e.values.length;r<l;r++){var i=Object(c.e)(n(e.values[r]));t.push([a(i.r),a(i.g),a(i.b)])}e.marker.color=t})),e.colorScale=n}e.data=e.data.slice()})),e.slice();case N:return e.forEach((function(e){e.data.forEach((function(e){e.marker.opacity=t.payload})),e.data=e.data.slice()})),e.slice();case U:return e.forEach((function(e){e.data.forEach((function(e){e.unselected.marker.opacity=t.payload})),e.data=e.data.slice()})),e.slice();case Z:return[];default:return e}},markerSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ia,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L:return t.payload;case Z:return ia;case ne:return null!=t.payload.markerSize?t.payload.markerSize:e;default:return e}},loading:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ie:return t.payload;default:return e}},plotConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;switch((arguments.length>1?arguments[1]:void 0).type){case Z:return A.createPlotConfig();default:return e}},message:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case H:return t.payload;default:return e}},selectedpoints:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R:return t.payload;case Z:case F:return[];case ne:return null!=t.payload.selectedpoints?t.payload.selectedpoints:e;default:return e}},markerOpacity:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return t.payload;case Z:return oa;case ne:return null!=t.payload.markerOpacity?t.payload.markerOpacity:e;default:return e}},markerOpacityUI:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:case ue:return t.payload;case Z:return oa;case ne:return null!=t.payload.markerOpacity?t.payload.markerOpacity:e;default:return e}},numberOfBinsUI:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ua,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case W:case se:return t.payload;case Z:return ua;case ne:return null!=t.payload.numberOfBins?t.payload.numberOfBins:e;default:return e}},markerSizeUI:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L:case ce:return t.payload;case Z:return ia;case ne:return null!=t.payload.markerSize?t.payload.markerSize:e;default:return e}},interpolator:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case X:return t.payload;case ne:return null!=t.payload.colorScheme?t.payload.colorScheme:e;default:return e}},serverInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return t.payload;default:return e}},selectedValueCounts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case V:return t.payload;case Z:return{};default:return e}},unselectedMarkerOpacity:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:sa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U:return t.payload;case Z:return sa;case ne:return null!=t.payload.unselectedMarkerOpacity?t.payload.unselectedMarkerOpacity:e;default:return e}},unselectedMarkerOpacityUI:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:sa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case U:case de:return t.payload;case Z:return sa;case ne:return null!=t.payload.unselectedMarkerOpacity?t.payload.unselectedMarkerOpacity:e;default:return e}}}),ma=Object(O.a)(","),fa=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(f.a)(this,Object(g.a)(t).call(this,e))).handleUserMenuClose=function(){a.setState({userMenuOpen:!1})},a.handleMessageClose=function(){a.props.setMessage(null)},a.handleUserMenuOpen=function(e){a.setState({userMenuOpen:!0,userMenuAnchorEl:e.currentTarget})},a.handleLinkMenuClose=function(e){a.setState({linkMenuOpen:!1,linkMenuAnchorEl:null})},a.copyLink=function(){a.linkRef.current.focus(),a.linkRef.current.select(),document.execCommand("copy"),a.props.setMessage("Link copied")},a.handleLinkMenuOpen=function(e){var t=window.location.protocol+"//"+window.location.host,n={dataset:a.props.dataset.id,features:a.props.features,groupBy:a.props.groupBy,embedding:a.props.embedding};a.props.markerSize!==ia&&(n.markerSize=a.props.markerSize),a.props.markerOpacity!==oa&&(n.markerOpacity=a.props.markerOpacity),a.props.binValues&&(n.binValues=!0,a.props.binSummary!==ca&&(n.binSummary=a.props.binSummary),a.props.numberOfBins!==ua&&(n.numberOfBins=a.props.numberOfBins)),a.props.view3d&&(n["3d"]=!0),a.props.interpolator.name!==da&&(n.colorScheme=a.props.interpolator.name),t+="?q="+JSON.stringify(n),a.setState({linkMenuOpen:!0,linkMenuAnchorEl:e.currentTarget,linkText:t})},a.handleLogout=function(){a.setState({userMenuOpen:!1}),a.props.handleLogout()},a.handleDataset=function(e){"importDataset"===e.target.value?a.props.handleDialog(ee):a.props.handleDataset(e.target.value)},a.handleSettings=function(e){a.props.handleDialog($)},a.handleDelete=function(e){a.props.handleDialog(te)},a.state={userMenuOpen:!1,linkMenuOpen:!1,userMenuAnchorEl:null,linkMenuAnchorEl:null,linkText:null},a.linkRef=r.a.createRef(),a}return Object(y.a)(t,e),Object(E.a)(t,[{key:"componentDidUpdate",value:function(e,t,a){var n=this;this.state.linkMenuOpen&&window.requestAnimationFrame((function(){n.linkRef.current.focus(),n.linkRef.current.select()}))}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement("div",{className:e.root},(this.props.dialog===$||this.props.dialog===ee)&&r.a.createElement(Ct,null),this.props.dialog===te&&r.a.createElement(mt,null),r.a.createElement(Ve.a,{position:"fixed",color:"default",className:e.appBar},r.a.createElement(Je.a,{variant:"dense"},r.a.createElement("div",null,r.a.createElement(at.a,{style:{verticalAlign:"bottom"},fontSize:"large"}),r.a.createElement("h3",{style:{display:"inline",marginRight:20}},"Cirrocumulus"),this.props.loadingApp&&r.a.createElement("span",null,"Loading..."),null!=this.props.email&&r.a.createElement(He.a,{disableUnderline:!0,displayEmpty:!0,value:null==this.props.dataset?"":this.props.dataset.id,onChange:this.handleDataset,inputProps:{name:"dataset",id:"dataset-id"}}," ",this.props.datasetChoices.length>0&&r.a.createElement(qe.a,{key:"",value:"",disabled:!0},"Choose a dataset"),this.props.datasetChoices.map((function(e){return r.a.createElement(qe.a,{key:e.id,value:e.id},e.name)})),this.props.user.importer&&this.props.datasetChoices.length>0&&r.a.createElement("hr",null),this.props.user.importer&&r.a.createElement(qe.a,{key:"importDataset",value:"importDataset"},"Import...")),r.a.createElement("div",{style:{display:"inline-block",marginLeft:"10px"}},null!=this.props.dataset&&this.props.dataset.nObs>0&&this.props.selectedValueCounts.count>0&&ma(this.props.selectedValueCounts.count)+" / "+ma(this.props.dataset.nObs)+" cells",null!=this.props.dataset&&!(this.props.selectedValueCounts.count>0)&&this.props.dataset.nObs>0&&ma(this.props.dataset.nObs)+" cells")),r.a.createElement("div",{style:{marginLeft:"auto"}},null!=this.props.dataset&&r.a.createElement(Le.a,{title:"Link"},r.a.createElement(Ne.a,{"aria-owns":this.state.linkMenuOpen?"link-popper":void 0,"aria-haspopup":"true",onClick:this.handleLinkMenuOpen,"aria-label":"Link"},r.a.createElement(it.a,null))),null!==this.props.dataset&&this.props.dataset.owner&&r.a.createElement(Le.a,{title:"Edit"},r.a.createElement(Ne.a,{onClick:this.handleSettings,"aria-label":"Edit"},r.a.createElement(st.a,null))),null!==this.props.dataset&&this.props.dataset.owner&&r.a.createElement(Le.a,{title:"Delete"},r.a.createElement(Ne.a,{onClick:this.handleDelete,"aria-label":"Delete"},r.a.createElement(rt.a,null))),null!=this.props.dataset&&r.a.createElement(Ke.a,{id:"link-popper",open:this.state.linkMenuOpen,anchorEl:this.state.linkMenuAnchorEl,onClose:this.handleLinkMenuClose,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},r.a.createElement("div",{style:{padding:10}},r.a.createElement("h4",null,"Copy link to share your current view"),r.a.createElement(ze.a,{variant:"outlined",onClick:this.copyLink},"Copy")," ",r.a.createElement(We.a,{autoFocus:!0,inputRef:this.linkRef,readOnly:!0,value:this.state.linkText}))),null!=this.props.email&&r.a.createElement(Le.a,{title:this.props.email},r.a.createElement(Ne.a,{style:{marginLeft:50},"aria-label":"Menu","aria-haspopup":"true",onClick:this.handleUserMenuOpen},r.a.createElement(Qe.a,null))),null!=this.props.email&&r.a.createElement(Ue.a,{id:"menu-user",anchorEl:this.state.userMenuAnchorEl,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:this.state.userMenuOpen,onClose:this.handleUserMenuClose},r.a.createElement(qe.a,{onClick:this.handleLogout},"Sign Out")),!this.props.loadingApp&&null==this.props.email&&r.a.createElement(ze.a,{style:{whiteSpace:"nowrap"},variant:"outlined",color:"primary",onClick:this.props.handleLogin},"Sign In")))),r.a.createElement(Fe.a,{className:e.drawer,variant:"permanent",classes:{paper:e.drawerPaper},anchor:"left"},null!=this.props.dataset&&r.a.createElement(la,{key:this.props.dataset.id})),r.a.createElement("div",null),r.a.createElement("main",{className:e.content},null!=this.props.dataset&&r.a.createElement(At,null),null!=this.props.dataset&&r.a.createElement(Ot,null)),this.props.loading&&r.a.createElement(Re.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},ContentProps:{"aria-describedby":"loading-id"},open:!0,message:r.a.createElement("span",{id:"loading-id"},r.a.createElement(Ge.a,{size:20})," Loading...")}),null!=this.props.message&&r.a.createElement(Re.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},ContentProps:{"aria-describedby":"message-id"},onClose:this.handleMessageClose,open:!0,autoHideDuration:6e3,action:[r.a.createElement(Ne.a,{key:"close","aria-label":"Close",color:"inherit",onClick:this.handleMessageClose},r.a.createElement(et.a,null))],message:r.a.createElement("span",{id:"message-id"},this.props.message instanceof Error?this.props.message.message:this.props.message)}))}}]),t}(n.PureComponent),ga=Ye()((function(e){return{root:{display:"flex"},appBar:{width:"calc(100% - ".concat(240,"px)"),marginLeft:240},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},toolbar:e.mixins.toolbar,content:{flexGrow:1,backgroundColor:e.palette.background.default,paddingTop:e.spacing(6.5),paddingLeft:e.spacing(1)}}}))(Object(i.b)((function(e){return{message:e.message,loadingApp:e.loadingApp,loading:e.loading,dialog:e.dialog,email:e.email,dataset:e.dataset,datasetChoices:e.datasetChoices,selectedValueCounts:e.selectedValueCounts,features:e.features,groupBy:e.groupBy,markerSize:e.markerSize,markerOpacity:e.markerOpacity,embedding:e.embedding,view3d:e.view3d,numberOfBins:e.numberOfBins,binSummary:e.binSummary,binValues:e.binValues,interpolator:e.interpolator,selectedpoints:e.selectedpoints,user:e.user}}),(function(e){return{handleLogin:function(){e((function(e,t){window.gapi.auth2.getAuthInstance().signIn().then((function(t){e(Ee())}))}))},handleLogout:function(){e(fe())},handleDataset:function(t){e(De(t))},handleDialog:function(t){e(Se(t))},setMessage:function(t){e(Ce(t))}}}))(fa)),ya=a(224),va=a(120),ba=Object(va.a)({palette:{type:"light"}}),Ea=Object(o.d)(ha,Object(o.a)(s.a));Ea.dispatch((function(e,t){fetch(x+"/server").then((function(e){return e.json()})).then((function(t){if(""==t.clientId)e(Me(!1)),e(Ae("")),e(Ie()).then((function(){e(be()),e((function(e,t){null==t().dataset&&1===t().datasetChoices.length&&e(De(t().datasetChoices[0].id))}))}));else{var a=document.createElement("script");a.type="text/javascript",a.src="https://apis.google.com/js/api.js",e({type:D,payload:t}),a.onload=function(a){window.gapi.load("client:auth2",(function(){window.gapi.client.init({clientId:t.clientId,discoveryDocs:[],scope:_.join(" ")}).then((function(){e(Me(!1)),e(Ee(!0))}))}))},document.getElementsByTagName("head")[0].appendChild(a)}}))})),Object(l.render)(r.a.createElement(i.a,{store:Ea},r.a.createElement(ya.a,{theme:ba},r.a.createElement(ga,null))),document.getElementById("root"))}},[[146,1,2]]]);
//# sourceMappingURL=main.f46dbadb.chunk.js.map