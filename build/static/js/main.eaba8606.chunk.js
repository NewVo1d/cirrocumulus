(window.webpackJsonpcirrocumulus=window.webpackJsonpcirrocumulus||[]).push([[0],{151:function(e,t,a){e.exports=a(177)},177:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(12),i=a(27),o=a(50),s=a(113),c=a(31),u=a(64),d=a(239),p=a(216),h=a(109),m=a(114),f=a(13),g=a(18),y=a(14),v=a(16),b=a(128),E=function(e){function t(){return Object(f.a)(this,t),Object(g.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(v.a)(t,e),t}(Object(b.a)(Error)),O=a(17),k=a(21),C=a(71),S={Diverging:["interpolateBrBG","interpolatePRGn","interpolatePiYG","interpolatePuOr","interpolateRdBu","interpolateRdGy","interpolateRdYlBu","interpolateRdYlGn","interpolateSpectral"],"Sequential (Single Hue)":["interpolateBlues","interpolateGreens","interpolateGreys","interpolateOranges","interpolatePurples","interpolateReds"],"Sequential (Multi-Hue)":["interpolateViridis","interpolateInferno","interpolateMagma","interpolatePlasma","interpolateWarm","interpolateCool","interpolateCubehelixDefault","interpolateBuGn","interpolateBuPu","interpolateGnBu","interpolateOrRd","interpolatePuBuGn","interpolatePuBu","interpolatePuRd","interpolateRdPu","interpolateYlGnBu","interpolateYlGn","interpolateYlOrBr","interpolateYlOrRd"],Cyclical:["interpolateRainbow","interpolateSinebow"]},w=Object(k.a)(","),j=Object(k.a)(".1f");function P(e){return e.startsWith("interpolate")||(e="interpolate"+e),C[e]}var M=function(){function e(){Object(f.a)(this,e)}return Object(O.a)(e,null,[{key:"convertPointsToBins",value:function(e,t){for(var a=[],n=0,r=e.length;n<r;n++)a.push(t[e[n]]);return a}},{key:"convertBinsToPoints",value:function(e,t){for(var a=[],n=0,r=0,l=e.length;r<l;r++)e[r]===t[n]&&(a.push(r),n++);return a}},{key:"createPlotConfig",value:function(){return{showLink:!0,responsive:!1,displaylogo:!1,modeBarButtonsToRemove:["hoverCompareCartesian","hoverClosestCartesian","toggleSpikelines"]}}},{key:"createEmbeddingAxis",value:function(){return{showbackground:!1,autorange:!0,showgrid:!1,zeroline:!1,showline:!1,title:"",autotick:!1,ticks:"",showticklabels:!1}}},{key:"createDotPlotAxis",value:function(){return{showbackground:!1,autorange:!0,showgrid:!1,zeroline:!1,showline:!1,title:"",type:"category"}}},{key:"getEmbeddingChartSize",value:function(e){var t=Math.floor(Math.min(window.screen.availWidth-240,window.screen.availHeight-190));return Math.floor(t/e)}},{key:"createEmbeddingLayout",value:function(t){var a=t.size,n=t.is3d,r={hovermode:"closest",dragmode:"select",width:a=e.getEmbeddingChartSize(a),height:a,margin:{l:0,b:0,r:0,t:0,autoexpand:!1},legend:{yanchor:"top"},autosize:!1,displaylogo:!1,showlegend:!1};return n?r.scene={xaxis:e.createEmbeddingAxis(),yaxis:e.createEmbeddingAxis(),zaxis:e.createEmbeddingAxis()}:(r.xaxis=e.createEmbeddingAxis(),r.yaxis=e.createEmbeddingAxis()),r}},{key:"createDotPlotLayout",value:function(t){var a={hovermode:"closest",dragmode:"select",width:t.width,height:t.height,margin:{l:50,b:50,r:100,t:0,autoexpand:!0},legend:{yanchor:"top"},autosize:!0,displaylogo:!1,showlegend:!1};return a.xaxis=e.createDotPlotAxis(),a.yaxis=e.createDotPlotAxis(),a}}]),e}(),x="/api",z=["email","profile","https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/contacts.readonly","https://www.googleapis.com/auth/devstorage.full_control"],A="SET_UNSELECTED_MARKER_SIZE",D="SET_UNSELECTED_MARKER_SIZE_UI",T="SET_SERVER_INFO",_="SET_CATEGORICAL_FILTER",U="ADD_DATASET",B="DELETE_DATASET",I="UPDATE_DATASET",N="SET_MARKER_SIZE",L="SET_MARKER_OPACITY",R="SET_EMBEDDING_CHART_SIZE",V="SET_UNSELECTED_MARKER_OPACITY",F="SET_SELECTED_VALUE_COUNTS",H="SET_FEATURES",G="SET_GROUP_BY",K="SET_SELECTED_EMBEDDING",W="SET_NUMBER_OF_BINS",q="SET_BIN_VALUES",Y="SET_BIN_SUMMARY",X="SET_MESSAGE",J="SET_INTERPOLATOR",Z="SET_EMAIL",Q="SET_USER",$="SET_DATASET",ee="SET_DIALOG",te="EDIT_DATASET_DIALOG",ae="IMPORT_DATASET_DIALOG",ne="DELETE_DATASET_DIALOG",re="SET_DATASET_CHOICES",le="RESTORE_VIEW",ie="SET_DOT_PLOT_DATA",oe="SET_EMBEDDING_DATA",se="SET_LOADING",ce="LOADING_APP",ue="SET_NUMBER_OF_BINS_UI",de="SET_MARKER_SIZE_UI",pe="SET_MARKER_OPACITY_UI",he="SET_UNSELECTED_MARKER_OPACITY_UI",me=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],fe=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];function ge(){return function(e,t){fetch(x+"/user",{headers:{Authorization:"Bearer "+Se(),"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){return e({type:Q,payload:t})}))}}function ye(){return function(e,t){window.gapi.auth2.getAuthInstance().signOut().then((function(){e({type:Z,payload:null}),e(Ae(null))}))}}function ve(e){var t=e.dataset.id,a=e.features,n=e.groupBy,r=e.embeddings,l={id:t,embedding:r.length>0?r[0]:null,keys:a.concat(n)};return e.binValues&&(l.nbins=e.numberOfBins),Object.keys(e.categoricalFilter).length>0&&(l.c=e.categoricalFilter),l}function be(e,t,a){var n,r=ve(a());return e.length>0&&(r.p=e),(n=null==r.embedding||0===e.length&&null==r.c?Promise.resolve({}):fetch(x+"/selected_value_counts",{body:JSON.stringify(r),method:"POST",headers:{Authorization:"Bearer "+Se()}}).then((function(e){return e.json()}))).then((function(e){return t({type:F,payload:e})})),n}function Ee(e){return function(t,a){for(var n,r=e.name,l=e.value,i=e.shiftKey,o=e.metaKey,s=a().categoricalFilter,c=a().embeddingData,u=0;u<c.length;u++)if(c[u].data[0].name===r){n=c[u].colorScale.domain();break}var d=s[r];if(null==d&&(d=[],s[r]=d),i&&d.length>0){var p=n.indexOf(d[d.length-1]),h=n.indexOf(l);if(h>p)for(var m=p;m<=h;m++){var f=d.indexOf(l);-1!==f&&d.splice(f,1),d.push(n[m])}else for(var g=p;g>=h;g--){var y=d.indexOf(l);-1!==y&&d.splice(y,1),d.push(n[g])}}else{var v=d.indexOf(l);o||(d=[],s[r]=d),-1!==v?(d.splice(v,1),0===d.length&&delete s[r]):d.push(l)}t(function(e){return{type:_,payload:e}}(s)),be([],t,a)}}function Oe(e){var t=null==e||0===e.points.length,a=t?[]:e.points[0].data.selectedpoints;return t||null==e.points[0].data.bins||(a=M.convertPointsToBins(a,e.points[0].data.bins)),function(e,t){be(a,e,t)}}function ke(){return function(e,t){var a=window.location.search.substring(3);if(0!==a.length){var n;try{n=JSON.parse(window.decodeURIComponent(a))}catch(l){return e(Pe("Unable to restore saved view."))}if(null!=n.dataset){if(null!=n.colorScheme){var r=P(n.colorScheme);null!=r&&(n.colorScheme={name:n.colorScheme,value:r})}e(Ue(n.dataset)).then((function(){return e({type:le,payload:n})})).then((function(){return e(Be({embedding:!0,dotPlot:!0,clear:!0}))})).catch((function(t){console.log(t),e(Pe("Unable to restore saved view."))}))}}}}function Ce(e){return function(t,a){if(window.gapi.auth2.getAuthInstance().isSignedIn.get()){var n=window.gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile().getEmail();t(De(n)),t(ge()),t(Ne()).then((function(){e&&t(ke())}))}}}function Se(){return"undefined"!==typeof window.gapi?window.gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().id_token:""}function we(e){return function(t,a){var n=e.readers,r=e.name,l=e.url;if(""!=r&&""!==l){var i=null!=e.dataset;t(xe(!0));var o=a().serverInfo.email,s=!i||l!==e.dataset.url;Promise.resolve({ok:!0}).then((function(e){})).then((function(){return fetch(x+"/dataset",{body:JSON.stringify({id:null!=e.dataset?e.dataset.id:null,url:l,name:r,readers:n}),method:i?"PUT":"POST",headers:{Authorization:"Bearer "+Se()}})})).then((function(e){return e.json()})).then((function(e){i?(t(function(e){return{type:I,payload:e}}({name:r,id:e.id,owner:!0})),t(Pe(s?"Please ensure that "+o+' is a "Storage Object Viewer"':"Dataset updated"))):(t(function(e){return{type:U,payload:e}}({name:r,id:e.id,owner:!0})),t(Pe(s?"Please ensure that "+o+' is a "Storage Object Viewer"':"Dataset created")))})).finally((function(){t(xe(!1)),t(Me(null))})).catch((function(e){Ie(t,e)}))}}}function je(e){return function(t,a){t(xe(!0)),fetch(x+"/dataset",{body:JSON.stringify({id:e.dataset.id}),method:"DELETE",headers:{Authorization:"Bearer "+Se()}}).then((function(){t(function(e){return{type:B,payload:e}}({id:e.dataset.id})),t(Pe("Dataset deleted"))})).finally((function(){t(xe(!1)),t(Me(null))})).catch((function(e){Ie(t,e,"Unable to delete dataset. Please try again.")}))}}function Pe(e){return{type:X,payload:e}}function Me(e){return{type:ee,payload:e}}function xe(e){return{type:se,payload:e}}function ze(e){return{type:ce,payload:e}}function Ae(e){return{type:$,payload:e}}function De(e){return{type:Z,payload:e}}function Te(e){var t=e;return function(e,a){var n=a(),r=n.dataset.obsCat,l=n.features,i=n.groupBy,o=[],s=[];t.forEach((function(e){-1!==r.indexOf(e)?s.push(e):o.push(e)})),o.length!==l.length&&e(function(e){return function(t,a){var n=a().features;t({type:H,payload:e}),t(Be({embedding:!0,dotPlot:!0},(function(e){t({type:H,payload:n})})))}}(o)),s.length!==i.length&&e(function(e){return function(t,a){var n=a().groupBy,r=a().categoricalFilter,l=!1;for(var i in r)-1===e.indexOf(i)&&(delete r[i],l=!0);l&&t({type:_,payload:r}),t({type:G,payload:e}),t(Be({embedding:!0,dotPlot:!0},(function(e){t({type:G,payload:n})})))}}(s))}}function _e(e){return function(t,a){var n=a().embeddings;t({type:K,payload:e}),t(Be({embedding:!0,clear:!0},(function(e){t({type:K,payload:n})})))}}function Ue(e){return function(t,a){for(var n=a().datasetChoices,r=null,l=0;l<n.length;l++)if(n[l].id===e){r=n[l];break}if(null!=r)return t(Ae({owner:r.owner,name:r.name,id:e,embeddings:[],features:[],obs:[],obsCat:[]})),t(xe(!0)),fetch([x+"/schema?id="+e].join(""),{headers:{Authorization:"Bearer "+Se()}}).then((function(e){return e.json()})).then((function(a){var n;return"1"===a.version&&(n={owner:r.owner,name:r.name,id:e,embeddings:a.embeddings,features:a.var,obsCat:a.obs_cat,nObs:a.n_obs,obs:a.obs}),t(Ae(n)),t((function(e,t){var a=t().dataset.embeddings.map((function(e){return e.name})),n={X_fle:1,X_umap:2,X_tsne:3,X_fitsne:4};a.sort((function(e,t){return(e=n[e]||Number.MAX_VALUE)-(t=n[t]||Number.MAX_VALUE)})),a.length>0&&e(_e([a[0]]))})),n})).finally((function(){t(xe(!1))})).catch((function(e){Ie(t,e,"Unable to retrieve dataset. Please try again.")}));t(Pe("Unable to find dataset"))}}function Be(e,t){return function(a,n){var r=n().features,l=n().groupBy;if(null!=n().dataset){a(xe(!0));var i=n().dataset.id,o=n().dataset.obs,s=n().embeddings;e.embedding&&0===s.length&&(e.embedding=!1),e.dotPlot&&0===r.length&&(e.dotPlot=!1);var m=n().embeddingData,f=n().embeddingChartSize;e.clear&&(m=[]);var g={},y=r.concat(l),v=0,b=n().markerSize,E=n().markerOpacity,O=n().unselectedMarkerSize,k=n().unselectedMarkerOpacity;m.forEach((function(e){g[e.name]=!0;var t=-1!==y.indexOf(e.name);t&&(e.date=new Date,e.layout=M.createEmbeddingLayout({size:f,is3d:s[0].endsWith("3d"),title:e.name})),e.active=t}));var C=[x+"/slice?id="+i],S=[x+"/slice?id="+i],w=0;r.forEach((function(e){-1===o.indexOf(e)&&(S.push("&key="+e),w++),null!=g[e]||(v++,C.push("&key="+e))})),(e.embedding||e.dotPlot)&&l.forEach((function(e){S.push("&key="+e),null!=g[e]||(v++,C.push("&key="+e))}));var j=n().numberOfBins>0&&n().binValues;e.embedding&&j&&(C.push("&nbins="+n().numberOfBins),C.push("&reduce_function="+n().binSummary)),e.embedding&&s.length>0&&s.forEach((function(e){return C.push("&embedding="+e)}));var P=n().interpolator,z=[];if(e.dotPlot){var A=null;A=w>0&&l.length>0?fetch(S.join(""),{headers:{Authorization:"Bearer "+Se()}}).then((function(e){return e.json()})):Promise.resolve({stats:{}}),z.push(A),A.then((function(e){var t;a((t=e.dotplot||null,{type:ie,payload:t}))}))}if(e.embedding){var D,T=be([],a,n);D=0===v&&m.filter((function(e){return e.active})).length>0?Promise.resolve({embedding:{coordinates:{},values:{}}}):fetch(C.join(""),{headers:{Authorization:"Bearer "+Se()}}).then((function(e){return e.json()})),z.push(D),z.push(T);var _=Object(u.a)().domain([0,255]).range([0,1]);Promise.all([D,T]).then((function(e){var t,r=e[0],l=n().selectedValueCounts,i=r.embedding.values,o=r.embedding.categories,u=r.embedding.coordinates,g=r.embedding.bins,y=s[0].endsWith("3d"),v=l.indices;for(var C in null!=l.bins&&(v=M.convertBinsToPoints(g,l.bins)),null!=v&&0===v.length&&(v=null),i){var S=u[s[0]+"_1"],w=u[s[0]+"_2"],j=u[s[0]+"_3"],x=i[C],z=null!=o[C],A=null,D=null,T=null;if(z){var U=o[C].values;(A=Object(p.a)(U.length<=10?h.a:U.length<=20?me:me.concat(fe)).domain(U)).valueCounts=o[C]}else{D=Number.MAX_VALUE,T=-Number.MAX_VALUE;for(var B=0,I=x.length;B<I;B++){var N=x[B];D=N<D?N:D,T=N>T?N:T}(A=Object(d.a)(P.value).domain([D,T])).valueCounts=r.embedding.obs[C]}for(var L=[],R=0,V=x.length;R<V;R++){var F=Object(c.e)(A(x[R]));L.push([_(F.r),_(F.g),_(F.b)])}var H={hoverinfo:"text",showlegend:!1,name:C,mode:"markers",type:y?"scatter3d":"scattergl",hoveron:"points",x:S,y:w,bins:g,marker:{size:b,color:L,opacity:E,showscale:!1},unselected:{marker:{opacity:k,size:O}},selectedpoints:v,values:x,text:x};y&&(H.z=j),H=[H],m.push({date:new Date,active:!0,colorScale:A,continuous:!z,data:H,name:C,layout:M.createEmbeddingLayout({size:f,is3d:y,title:C}),isCategorical:z})}m.sort((function(e,t){return(e=e.name.toLowerCase())<(t=t.name.toLowerCase())?-1:1})),a((t=m.slice(0),{type:oe,payload:t}))}))}Promise.all(z).finally((function(){a(xe(!1))})).catch((function(e){Ie(a,e,"Unable to retrieve data. Please try again."),t&&t(e)}))}}}function Ie(e,t,a){if(console.log(t),401===t.status)return e(Pe("Your session has expired. Please login again.")),e(ye());null==a&&(a=t instanceof E?t.message:"An unexpected error occurred. Please try again."),e(Pe(new Error(a)))}function Ne(){return function(e,t){return e(xe(!0)),fetch(x+"/datasets",{headers:{Authorization:"Bearer "+Se()}}).then((function(e){return e.json()})).then((function(t){e({type:re,payload:t})})).finally((function(){e(xe(!1))})).catch((function(t){Ie(e,t,"Unable to retrieve datasets. Please try again.")}))}}var Le=a(249),Re=a(234),Ve=a(129),Fe=a(241),He=a(236),Ge=a(224),Ke=a(226),We=a(217),qe=a(221),Ye=a(243),Xe=a(227),Je=a(238),Ze=a(242),Qe=a(230),$e=a(240),et=a(63),tt=a.n(et),at=a(237),nt=a(124),rt=a.n(nt),lt=a(125),it=a.n(lt),ot=a(120),st=a.n(ot),ct=a(79),ut=a.n(ct),dt=a(122),pt=a.n(dt),ht=a(123),mt=a.n(ht),ft=a(223),gt=a(222),yt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(g.a)(this,Object(y.a)(t).call(this,e))).handleClose=function(){a.props.handleCancel()},a.handleDelete=function(){a.setState({loading:!0}),a.props.handleDelete({dataset:a.props.dataset})},a.state={open:!0},a}return Object(v.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){return r.a.createElement(We.a,{open:this.state.open,onClose:this.handleClose,"aria-labelledby":"delete-dataset-dialog-title",fullWidth:!0,maxWidth:"sm"},r.a.createElement(qe.a,{id:"delete-dataset-dialog-title"},"Delete Dataset"),r.a.createElement(gt.a,null,r.a.createElement("h3",null,"Are you sure you want to delete ",this.props.dataset.name,"?")),r.a.createElement(ft.a,null,r.a.createElement(Ge.a,{disabled:this.state.loading,onClick:this.handleClose,color:"primary"},"Cancel"),r.a.createElement(Ge.a,{disabled:this.state.loading,onClick:this.handleDelete,color:"primary"},"Delete ",r.a.createElement(ut.a,null))))}}]),t}(r.a.PureComponent),vt=Object(i.b)((function(e){return{dataset:e.dataset,email:e.email}}),(function(e){return{handleDelete:function(t){e(je(t))},handleCancel:function(t){e(Me(null))}}}))(yt),bt=a(116),Et=a.n(bt),Ot=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(g.a)(this,Object(y.a)(t).call(this,e))).handleStart=function(e){},a.handleDrag=function(e,t){},a.handleStop=function(e){},a.ref=r.a.createRef(),a.backingScale=1,a}return Object(v.a)(t,e),Object(O.a)(t,[{key:"redraw",value:function(){var e=this.backingScale,t=this.ref.current.getContext("2d"),a=this.props.height,n=this.props.width;t.clearRect(0,0,n*e,a*e),t.scale(e,e);var r=this.props.scale;if(null!=r){var l=r.domain();if(l[0]!==l[1]){for(var i=l[0],o=this.props.nsteps||10,s=(l[1]-l[0])/o,c=t.createLinearGradient(0,0,n,20),d=Object(u.a)().range([0,1]).domain(l).clamp(!0),p=0;p<o;p++){p===o-1&&(i=l[1]);var h=d(i);if(!isNaN(h)){var m=r(i);c.addColorStop(h,m)}i+=s}if(t.fillStyle=c,t.fillRect(0,0,n,20),t.strokeStyle="LightGrey",t.strokeRect(0,0,n,20),this.props.label>0){var f=Object(k.a)(".1f");t.font="12px Helvetica",t.textBaseline="top",t.fillStyle="black",t.textAlign="left",t.fillText(f(l[0]),0,22),t.textAlign="right",t.fillText(f(l[1]),n,22)}t.setTransform(1,0,0,1,0,0)}}}},{key:"componentDidMount",value:function(){this.redraw()}},{key:"componentDidUpdate",value:function(e,t,a){this.redraw()}},{key:"render",value:function(){var e=1;"undefined"!==typeof window&&"devicePixelRatio"in window&&(e=window.devicePixelRatio),this.backingScale=e;var t=this.props.height,a=this.props.width,n={width:a,height:t,display:"block"};return this.props.style&&(n=Object.assign({},n,this.props.style)),r.a.createElement("canvas",{width:a*e,height:t*e,ref:this.ref,style:n})}}]),t}(r.a.PureComponent),kt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(g.a)(this,Object(y.a)(t).call(this,e))).ref=r.a.createRef(),a.backingScale=1,a}return Object(v.a)(t,e),Object(O.a)(t,[{key:"redraw",value:function(){var e=this.backingScale,t=this.ref.current.getContext("2d"),a=this.props.height,n=this.props.width;t.clearRect(0,0,n*e,a*e),t.scale(e,e);var r=this.props.scale;if(null!=r){var l=r.domain(),i=l[0],o=this.props.nsteps||3,s=(l[1]-l[0])/o,c=Object(u.a)().range([25,n-25]).domain([0,o-1]).clamp(!0),d=Object(u.a)().range([2,10]).domain(l).clamp(!0),p=Object(k.a)(".0f");t.font="12px Helvetica",t.textBaseline="top",t.fillStyle="black",t.textAlign="center";for(var h=0;h<o;h++){h===o-1&&(i=l[1]);var m=c(h),f=d(i);t.beginPath(),t.arc(m,10,f,0,2*Math.PI),t.stroke(),t.fillText(p(100*i),m,22),i+=s}t.setTransform(1,0,0,1,0,0)}}},{key:"componentDidUpdate",value:function(e,t,a){this.redraw()}},{key:"componentDidMount",value:function(){this.redraw()}},{key:"render",value:function(){var e=1;"undefined"!==typeof window&&"devicePixelRatio"in window&&(e=window.devicePixelRatio),this.backingScale=e;var t=this.props.height,a=this.props.width,n={width:a,height:t};return this.props.style&&(n=Object.assign({},n,this.props.style)),r.a.createElement("canvas",{width:a*e,height:t*e,ref:this.ref,style:n})}}]),t}(r.a.PureComponent),Ct=Et()(window.Plotly),St=function(e){function t(){return Object(f.a)(this,t),Object(g.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){if(null==this.props.data)return r.a.createElement("div",null);var e=this.props.data,t=e.index||[""],a=Number.MAX_VALUE,n=-Number.MAX_VALUE,l=Number.MAX_VALUE,i=-Number.MAX_VALUE,o={};for(var s in e)if("index"!==s){var c=e[s],d=void 0,p=void 0,h=s.indexOf(","),m=s.substring(2,h-1),f=s.substring(h+3,s.length-2),g=o[m];void 0===g&&(g={},o[m]=g),"non_zero"===f?(d=l,p=i,g.fraction=c):"mean"===f?(d=a,p=n,g.summary=c):console.log("Unknown type: "+f+".");for(var y=0;y<c.length;y++)d=Math.min(d,c[y]),p=Math.max(p,c[y]);"non_zero"===f?(l=d,i=p):(a=d,n=p)}a===n&&n++,l===i&&(l=0,i=1);var v=Object(k.a)(".1f"),b=Object(u.a)().domain([a,n]).range(["blue","red"]),E=Object(u.a)().domain([l,i]).range([1,14]).clamp(!0),O=[],C=[],S=[],w=[],j=[],P=[];for(var x in o){P.push(x);for(var z=o[x],A=z.summary,D=z.fraction,T=0;T<A.length;T++)C.push(b(A[T])),O.push(E(D[T])),w.push(x),S.push(t[T]),j.push("mean: "+v(A[T])+", % non-zero: "+v(100*D[T]))}var _=[{type:"scatter",x:S,y:w,text:j,mode:"markers",name:"",sizemode:"diameter",marker:{color:C,symbol:"circle",size:O}}],U=M.createPlotConfig(),B=M.createDotPlotLayout({height:100+16*P.length,width:Math.max(300,70+16*t.length)});return r.a.createElement("div",{style:{maxWidth:800,overflow:"auto",border:"1px solid LightGrey"}},r.a.createElement(Ct,{data:_,layout:B,config:U}),r.a.createElement(Ot,{style:{display:"block"},width:300,label:!0,height:40,scale:b}),r.a.createElement(kt,{style:{display:"block"},width:150,label:!0,height:40,scale:E}))}}]),t}(r.a.PureComponent),wt=Object(i.b)((function(e){return{data:e.dotPlotData}}),(function(e){return{}}))(St),jt=a(244),Pt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(g.a)(this,Object(y.a)(t).call(this,e))).handleClose=function(){a.props.handleCancel()},a.handleSave=function(){var e=a.state.datasetName.trim(),t=a.state.url.trim();if(""!==e&&""!==t){a.setState({loading:!0});for(var n=a.state.readers.split(","),r=new Set,l=0;l<n.length;l++){var i=n[l].trim().toLowerCase();""!==i&&r.add(i)}var o=Array.from(r);a.props.handleSave({dataset:a.props.dataset,name:e,url:t,readers:o})}},a.onEmailChanged=function(e){a.setState({readers:e.target.value})},a.onUrlChanged=function(e){a.setState({url:e.target.value})},a.onDatasetNameChanged=function(e){a.setState({datasetName:e.target.value})},a.state={url:"",datasetName:null!=a.props.dataset?a.props.dataset.name:"",readers:"",loading:null!=a.props.dataset},a}return Object(v.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){var e=this;null!=this.props.dataset&&fetch(x+"/dataset?id="+this.props.dataset.id,{method:"GET",headers:{Authorization:"Bearer "+Se()}}).then((function(e){return e.json()})).then((function(t){var a=[];for(var n in t.roles)"reader"===t[n]&&a.push(n);e.setState({datasetName:t.name,loading:!1,url:t.url,readers:a.join(", ")})})).catch((function(t){e.props.handleError("Unable to retrieve dataset details. Please try again."),e.props.handleCancel()}))}},{key:"render",value:function(){return r.a.createElement(We.a,{open:!0,onClose:this.handleClose,"aria-labelledby":"edit-dataset-dialog-title",fullWidth:!0,maxWidth:"sm"},r.a.createElement(qe.a,{id:"edit-dataset-dialog-title"},null==this.props.dataset?"Import":"Edit"," Dataset"),r.a.createElement(gt.a,null,this.state.loading&&r.a.createElement(Ke.a,null),r.a.createElement(jt.a,{disabled:this.state.loading,required:!0,value:this.state.datasetName,onChange:this.onDatasetNameChanged,margin:"dense",label:"Dataset name",fullWidth:!0}),!this.state.loading&&r.a.createElement(jt.a,{required:!0,value:this.state.url,onChange:this.onUrlChanged,margin:"dense",helperText:"Please ensure that "+this.props.serverEmail+' has "Storage Object Viewer" permissions',label:"Dataset URL (gs://my_bucket/my_dataset.parquet)",fullWidth:!0}),!this.state.loading&&r.a.createElement(jt.a,{value:this.state.readers,onChange:this.onEmailChanged,margin:"dense",label:"Comma separated list of emails to share with",fullWidth:!0,multiline:!0})),r.a.createElement(ft.a,null,r.a.createElement(Ge.a,{disabled:this.state.loading,onClick:this.handleClose,color:"primary"},"Cancel"),r.a.createElement(Ge.a,{disabled:this.state.loading,onClick:this.handleSave,color:"primary"},"Save")))}}]),t}(r.a.PureComponent),Mt=Object(i.b)((function(e){return{dataset:e.dialog===te?e.dataset:null,serverEmail:e.serverInfo.email}}),(function(e){return{handleSave:function(t){e(we(t))},handleCancel:function(t){e(Me(null))},handleError:function(t){e(Pe(t))}}}))(Pt),xt=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(g.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).handleClick=function(e,t,n){a.props.clickEnabled&&(n.preventDefault(),a.props.handleClick({name:a.props.name,value:e,shiftKey:n.shiftKey,metaKey:n.metaKey}))},a}return Object(v.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.scale,n=t.categoricalFilter,l=t.name,i=t.selectedValueCounts,o=t.maxHeight,s=t.clickEnabled,c=n[l],u=null!=this.props.domain?this.props.domain:a.domain(),d=null!=i.categories?i.categories[l]:null;return r.a.createElement("div",{style:{display:"inline-block",padding:10,verticalAlign:"top",maxHeight:o,overflow:"auto"}},r.a.createElement("b",null,l),r.a.createElement("table",null,r.a.createElement("tbody",null,u.map((function(t,n){var l=function(e,t,a,n){if(null==t.valueCounts.total){for(var r=0,l=0,i=t.valueCounts.counts.length;l<i;l++)r+=t.valueCounts.counts[l];t.valueCounts.total=r}var o,s=t.valueCounts.counts[a],c=t.valueCounts.total,u=s/c,d=Number.NaN,p=w(s)+" / "+w(c)+" ("+j(100*u)+"% of total)";if(null!=e){var h=e[t.valueCounts.values[a]]||0;d=h/n,o=w(h)+" / "+w(n)+" % of selection ("+j(100*d)+"%)"}return{percentTotal:u,percentSelected:d,title:p,total:w(c),selectionTitle:o}}(d,a,n,i.count),o=null==c||-1!==c.indexOf(t)?1:.4,u=60*l.percentTotal,p=60*l.percentSelected;return r.a.createElement("tr",{style:{cursor:s?"pointer":null,opacity:o},onClick:function(a){return e.handleClick(t,n,a)},key:t},s&&r.a.createElement("td",null,r.a.createElement("div",{style:{display:"inline-block",width:10,height:10,background:a(t)}})),r.a.createElement("td",null,r.a.createElement("div",{style:{maxWidth:140,textOverflow:"ellipsis",overflow:"hidden",display:"inline-block",userSelect:"none"},title:""+t},""+t)),isNaN(p)?null:r.a.createElement("td",null,r.a.createElement("div",{title:l.selectionTitle,style:{display:"inline-block",position:"relative",width:60,border:"1px solid black",height:9}},r.a.createElement("div",{style:{position:"absolute",width:p,left:0,top:0,backgroundColor:"LightGrey",height:9}}))),r.a.createElement("td",null,r.a.createElement("div",{title:l.title,style:{display:"inline-block",position:"relative",width:60,border:"1px solid black",height:9}},r.a.createElement("div",{style:{position:"absolute",width:u,left:0,top:0,backgroundColor:"LightGrey",height:9}}))))}))),r.a.createElement("tfoot",null,r.a.createElement("tr",null,s&&r.a.createElement("td",null),r.a.createElement("td",null),null!=d?r.a.createElement("td",null,r.a.createElement("small",null,"selection")):null,r.a.createElement("td",null,r.a.createElement("small",null,null!=d?"group":null))))))}}]),t}(r.a.PureComponent),zt=function(e){function t(){return Object(f.a)(this,t),Object(g.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.scale,a=e.name,n=e.selectedValueCounts,l=e.maxHeight,i=e.style,o=null!=n.categories?n.categories[a]:null,s=null!=t.valueCounts?t.valueCounts.values:[];return o&&(null!=o.True&&(o.true=o.True),null!=o.False&&(o.false=o.False)),r.a.createElement("div",{style:{display:"inline-block",padding:10,verticalAlign:"top",maxHeight:l,overflow:"auto"}},r.a.createElement(xt,{scale:t,name:a,selectedValueCounts:n,maxHeight:l,domain:s,clickEnabled:!1,categoricalFilter:{}}),r.a.createElement(Ot,{width:this.props.width,height:this.props.height,style:i,scale:t,label:this.props.label}))}}]),t}(r.a.PureComponent),At=a(44),Dt=a(7),Tt=a.n(Dt),_t=["AfterExport","AfterPlot","Animated","AnimatingFrame","AnimationInterrupted","AutoSize","BeforeExport","ButtonClicked","Click","ClickAnnotation","Deselect","DoubleClick","Framework","Hover","LegendClick","LegendDoubleClick","Relayout","Restyle","Redraw","Selected","Selecting","SliderChange","SliderEnd","SliderStart","Transitioning","TransitionInterrupted","Unhover"],Ut=["plotly_restyle","plotly_redraw","plotly_relayout","plotly_doubleclick","plotly_animated"],Bt="undefined"!==typeof window;var It=function(e){var t=function(t){function a(e){var t;return Object(f.a)(this,a),(t=Object(g.a)(this,Object(y.a)(a).call(this,e))).p=Promise.resolve(),t.resizeHandler=null,t.handlers={},t.syncWindowResize=t.syncWindowResize.bind(Object(At.a)(t)),t.syncEventHandlers=t.syncEventHandlers.bind(Object(At.a)(t)),t.attachUpdateEvents=t.attachUpdateEvents.bind(Object(At.a)(t)),t.getRef=t.getRef.bind(Object(At.a)(t)),t.handleUpdate=t.handleUpdate.bind(Object(At.a)(t)),t.figureCallback=t.figureCallback.bind(Object(At.a)(t)),t.updatePlotly=t.updatePlotly.bind(Object(At.a)(t)),t}return Object(v.a)(a,t),Object(O.a)(a,[{key:"updatePlotly",value:function(t,a,n){var r=this;this.p=this.p.then((function(){var t;if(!r.el)throw r.unmounting?(t=new Error("Component is unmounting")).reason="unmounting":t=new Error("Missing element reference"),t;return e.newPlot(r.el,{data:r.props.data,layout:r.props.layout,config:r.props.config,frames:r.props.frames})})).then((function(){return r.syncWindowResize(t)})).then(this.syncEventHandlers).then((function(){return r.figureCallback(a)})).then(n?this.attachUpdateEvents:function(){}).catch((function(e){"unmounting"!==e.reason&&(console.error("Error while plotting:",e),r.props.onError&&r.props.onError(e))}))}},{key:"componentDidMount",value:function(){this.unmounting=!1,this.updatePlotly(!0,this.props.onInitialized,!0)}},{key:"componentDidUpdate",value:function(e){this.unmounting=!1;var t=e.frames&&e.frames.length?e.frames.length:0,a=this.props.frames&&this.props.frames.length?this.props.frames.length:0,n=!(e.layout===this.props.layout&&e.data===this.props.data&&e.config===this.props.config&&a===t),r=void 0!==e.revision,l=e.revision!==this.props.revision;(n||r&&(!r||l))&&this.updatePlotly(!0,this.props.onUpdate,!0)}},{key:"componentWillUnmount",value:function(){this.unmounting=!0,this.figureCallback(this.props.onPurge),this.resizeHandler&&Bt&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null),this.removeUpdateEvents(),e.purge(this.el)}},{key:"attachUpdateEvents",value:function(){var e=this;this.el&&this.el.removeListener&&Ut.forEach((function(t){e.el.on(t,e.handleUpdate)}))}},{key:"removeUpdateEvents",value:function(){var e=this;this.el&&this.el.removeListener&&Ut.forEach((function(t){e.el.removeListener(t,e.handleUpdate)}))}},{key:"handleUpdate",value:function(){this.figureCallback(this.props.onUpdate)}},{key:"figureCallback",value:function(e){if("function"===typeof e){var t=this.el;e({data:t.data,layout:t.layout,frames:this.el._transitionData?this.el._transitionData._frames:null},this.el)}}},{key:"syncWindowResize",value:function(t){var a=this;Bt&&(this.props.useResizeHandler&&!this.resizeHandler?(this.resizeHandler=function(){return e.Plots.resize(a.el)},window.addEventListener("resize",this.resizeHandler),t&&this.resizeHandler()):!this.props.useResizeHandler&&this.resizeHandler&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null))}},{key:"getRef",value:function(e){this.el=e,this.props.debug&&Bt&&(window.gd=this.el)}},{key:"syncEventHandlers",value:function(){var e=this;_t.forEach((function(t){var a=e.props["on"+t],n=e.handlers[t];Boolean(n)&&e.removeEventHandler(t),a&&e.addEventHandler(t,a)}))}},{key:"addEventHandler",value:function(e,t){this.handlers[e]=t,this.el.on(this.getPlotlyEventName(e),this.handlers[e])}},{key:"removeEventHandler",value:function(e){this.el.removeListener(this.getPlotlyEventName(e),this.handlers[e]),delete this.handlers[e]}},{key:"getPlotlyEventName",value:function(e){return"plotly_"+e.toLowerCase()}},{key:"render",value:function(){return r.a.createElement("div",{id:this.props.divId,style:this.props.style,ref:this.getRef,className:this.props.className})}}]),a}(n.Component);return t.propTypes&&_t.forEach((function(e){t.propTypes["on"+e]=Tt.a.func})),t.defaultProps={debug:!1,useResizeHandler:!1,data:[],style:{position:"relative",display:"inline-block"}},t}(window.Plotly),Nt=function(e){function t(e){return Object(f.a)(this,t),Object(g.a)(this,Object(y.a)(t).call(this,e))}return Object(v.a)(t,e),Object(O.a)(t,[{key:"getKey",value:function(e){var t=e.name;return this.props.binValues&&(t+="-"+this.props.numberOfBins),t}},{key:"getPlots",value:function(){var e=this,t=this.props.data.filter((function(e){return e.active})),a=M.getEmbeddingChartSize(1===t.length?1:this.props.embeddingChartSize);return t.map((function(t){return a!==t.layout.width&&(t.layout=Object.assign({},t.layout),t.layout.width=a,t.layout.height=a),r.a.createElement("div",{style:{display:"inline-block",border:"1px solid LightGrey"},key:t.name},r.a.createElement(It,{data:t.data,layout:t.layout,config:e.props.config,onDeselect:e.props.onDeselect,onSelected:e.props.onSelect}),t.continuous?r.a.createElement(zt,{width:186,label:!0,height:40,scale:t.colorScale,selectedValueCounts:e.props.selectedValueCounts,maxHeight:t.layout.height,name:t.name}):r.a.createElement(xt,{categoricalFilter:e.props.categoricalFilter,handleClick:e.props.handleLegendClick,name:t.name,scale:t.colorScale,maxHeight:t.layout.height,clickEnabled:!0,selectedValueCounts:e.props.selectedValueCounts}))}))}},{key:"render",value:function(){return this.getPlots()}}]),t}(r.a.PureComponent),Lt=Object(i.b)((function(e){return{data:e.embeddingData,numberOfBins:e.numberOfBins,binValues:e.binValues,embeddingChartSize:e.embeddingChartSize,config:e.plotConfig,categoricalFilter:e.categoricalFilter,selectedValueCounts:e.selectedValueCounts}}),(function(e){return{handleLegendClick:function(t){e(Ee(t))},onSelect:function(t){e(Oe(t))},onDeselect:function(){e(Oe(null))}}}))(Nt),Rt=a(248),Vt=a(235),Ft=a(229),Ht=a(233),Gt=a(246),Kt=a(232),Wt=a(56),qt=a(93),Yt=a(130),Xt=a(247),Jt=a(225),Zt=a(94),Qt=a(6),$t=a(90),ea=a(119),ta=a.n(ea),aa=a(117),na=a.n(aa),ra=a(126);function la(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ia(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?la(a,!0).forEach((function(t){Object(qt.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):la(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var oa={display:"flex",alignItems:"center",justifyContent:"space-between"},sa=function(e){return r.a.createElement("div",{style:oa},r.a.createElement("span",null,e.label))};function ca(e){var t=e.inputRef,a=Object(Yt.a)(e,["inputRef"]);return r.a.createElement("div",Object.assign({ref:t},a))}var ua={Control:function(e){return r.a.createElement(jt.a,Object.assign({fullWidth:!0,InputProps:{inputComponent:ca,inputProps:ia({className:e.selectProps.classes.input,inputRef:e.innerRef,children:e.children},e.innerProps)}},e.selectProps.textFieldProps))},Menu:function(e){return r.a.createElement(Zt.a,Object.assign({square:!0,className:e.selectProps.classes.paper},e.innerProps),e.children)},MultiValue:function(e){return r.a.createElement(Xt.a,{tabIndex:-1,label:e.children,className:na()(e.selectProps.classes.chip,Object(qt.a)({},e.selectProps.classes.chipFocused,e.isFocused)),onDelete:e.removeProps.onClick,deleteIcon:r.a.createElement(ta.a,e.removeProps)})},NoOptionsMessage:function(e){return r.a.createElement(Wt.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.noOptionsMessage},e.innerProps),e.children)},Option:function(e){return r.a.createElement(Ze.a,Object.assign({buttonRef:e.innerRef,selected:e.isFocused,component:"div",style:{fontWeight:e.isSelected?500:400}},e.innerProps),e.children)},Placeholder:function(e){return r.a.createElement(Wt.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)},SingleValue:function(e){return r.a.createElement(Wt.a,Object.assign({className:e.selectProps.classes.singleValue},e.innerProps),e.children)},ValueContainer:function(e){return r.a.createElement("div",{className:e.selectProps.classes.valueContainer},e.children)}},da=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(g.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).loadOptions=function(e,t){return t(a.filterOptions(e))},a.noOptionsMessage=function(){return"No matches"},a.onChange=function(e){a.props.isMulti?a.props.onChange(null==e||0===e.length?null:e.map((function(e){return e.value}))):a.props.onChange(e)},a.filterOptions=function(e){if(e){for(var t=1===(e=e.toLowerCase()).length?3:2===e.length?10:20,n=0,r=[],l=0,i=a.props.options.length;l<i;l++){var o=a.props.options[l],s={label:o.label,options:[]};r.push(s);for(var c=0,u=o.options.length;c<u;c++){var d=o.options[c];if(d.value.toLowerCase().startsWith(e)&&(n++,s.options.push(d),n===t))return r}}return r}return[]},a}return Object(v.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.theme,n={input:function(e){return ia({},e,{color:a.palette.text.primary,"& input":{font:"inherit"}})}};return r.a.createElement("div",{className:t.root},r.a.createElement(Jt.a,null,r.a.createElement(ra.a,{noOptionsMessage:this.noOptionsMessage,cacheOptions:!1,placeholder:"",loadOptions:this.loadOptions,classes:t,styles:n,textFieldProps:{label:this.props.label,helperText:this.props.helperText,InputLabelProps:{shrink:!0}},formatGroupLabel:sa,components:ua,onChange:this.onChange,value:this.props.value,isMulti:this.props.isMulti,defaultOptions:this.props.defaultOptions})))}}]),t}(r.a.Component),pa=Object(Qt.a)((function(e){return{root:{flexGrow:1},input:{display:"flex",padding:0,maxWidth:"220px",height:"100%"},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden"},chip:{margin:"".concat(e.spacing(1)/2,"px ").concat(e.spacing(1)/4,"px")},chipFocused:{backgroundColor:Object($t.emphasize)("light"===e.palette.type?e.palette.grey[300]:e.palette.grey[700],.08)},noOptionsMessage:{padding:"".concat(e.spacing(1),"px ").concat(2*e.spacing(1),"px")},singleValue:{fontSize:16},placeholder:{position:"absolute",left:2,fontSize:16},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0},divider:{height:2*e.spacing(1)}}}),{withTheme:!0})(da),ha=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(g.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).handleInterpolatorChange=function(e){var t=e.target.value;a.props.handleInterpolator({name:t,value:P(t)})},a}return Object(v.a)(t,e),Object(O.a)(t,[{key:"getScale",value:function(e){return Object(d.a)(C[e]).domain([0,1])}},{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement($e.a,{input:r.a.createElement(Xe.a,{id:"color-scheme"}),className:t.select,onChange:this.handleInterpolatorChange,value:this.props.interpolator.name,multiple:!1},r.a.createElement(Ze.a,{key:"Diverging",value:"Diverging",divider:!0,disabled:!0},"Diverging"),S.Diverging.map((function(t){return r.a.createElement(Ze.a,{value:t,key:t},r.a.createElement(Ot,{width:200,label:!1,height:24,scale:e.getScale(t)}))})),r.a.createElement(Ze.a,{key:"Sequential (Single Hue)",value:"Sequential (Single Hue)",divider:!0,disabled:!0},"Sequential (Single Hue)"),S["Sequential (Single Hue)"].map((function(t){return r.a.createElement(Ze.a,{value:t,key:t},r.a.createElement(Ot,{width:200,label:!1,height:20,scale:e.getScale(t)}))})),r.a.createElement(Ze.a,{key:"Sequential (Multi-Hue)",value:"Sequential (Multi-Hue)",divider:!0,disabled:!0},"Sequential (Multi-Hue)"),S["Sequential (Multi-Hue)"].map((function(t){return r.a.createElement(Ze.a,{value:t,key:t},r.a.createElement(Ot,{width:200,label:!1,height:20,scale:e.getScale(t)}))})),r.a.createElement(Ze.a,{key:"Cyclical",value:"Cyclical",divider:!0,disabled:!0},"Cyclical"),S.Cyclical.map((function(t){return r.a.createElement(Ze.a,{value:t,key:t},r.a.createElement(Ot,{width:200,label:!1,height:20,scale:e.getScale(t)}))})))}}]),t}(r.a.PureComponent),ma=tt()((function(e){return{root:{display:"flex",flexWrap:"wrap","flex-direction":"column"},formControl:{display:"block",margin:e.spacing(1),minWidth:200},select:{minWidth:200}}}))(Object(i.b)((function(e){return{interpolator:e.interpolator}}),(function(e){return{handleInterpolator:function(t){e({type:J,payload:t})}}}))(ha)),fa=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(g.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).onMarkerSizeChange=function(e){a.props.handleMarkerSizeUI(e.target.value)},a.onMarkerSizeKeyPress=function(e){if("Enter"===e.key){var t=parseFloat(e.target.value);t>0&&a.props.handleMarkerSize(t)}},a.onEmbeddingChartSizeChange=function(e){a.props.handleEmbeddingChartSize(e.target.value)},a.onMarkerSizeKeyPress=function(e){if("Enter"===e.key){var t=parseFloat(e.target.value);t>0&&a.props.handleMarkerSize(t)}},a.onUnselectedMarkerSizeChange=function(e){a.props.handleUnselectedMarkerSizeUI(e.target.value)},a.onUnselectedMarkerSizeKeyPress=function(e){if("Enter"===e.key){var t=parseFloat(e.target.value);t>0&&a.props.handleUnselectedMarkerSize(t)}},a.onMarkerOpacityChange=function(e){a.props.handleMarkerOpacityUI(e.target.value)},a.onMarkerOpacityKeyPress=function(e){if("Enter"===e.key){var t=parseFloat(e.target.value);t>0&&t<=1&&a.props.handleMarkerOpacity(t)}},a.onUnselectedMarkerOpacityChange=function(e){a.props.handleUnselectedMarkerOpacityUI(e.target.value)},a.onUnselectedMarkerOpacityKeyPress=function(e){if("Enter"===e.key){var t=parseFloat(e.target.value);t>0&&t<=1&&a.props.handleUnselectedMarkerOpacity(t)}},a.onNumberOfBinsChange=function(e){a.props.handleNumberOfBinsUI(e.target.value)},a.onNumberOfBinsKeyPress=function(e){if("Enter"===e.key){var t=parseInt(e.target.value);t>0&&a.props.handleNumberOfBins(t)}},a.onBinSummaryChange=function(e){a.props.handleBinSummary(e.target.value)},a.handleBinValuesChange=function(e){a.props.handleBinValues(e.target.checked)},a.handleViewChange=function(e){a.props.handleViewName(e.target.value)},a}return Object(v.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.embeddingChartSize,n=e.unselectedMarkerSize,l=e.selectedFeatures,i=e.selectedGroupBy,o=e.selectedEmbeddings,s=e.numberOfBins,c=e.markerSize,u=e.markerOpacity,d=e.unselectedMarkerOpacity,p=e.binValues,h=e.binSummary,m=e.dataset,f=null==m?[]:m.features,g=null==m?[]:m.embeddings,y=null==m?[]:m.obsCat,v=null==m?[]:m.obs,b=l.concat(i);b=b.map((function(e){return{label:e,value:e}}));var E=v.map((function(e){return{label:e,value:e}}));(E=E.concat(y.map((function(e){return{label:e,value:e,categorical:!0}})))).sort((function(e,t){return(e=e.label.toLowerCase())<(t=t.label.toLowerCase())?-1:e==t?0:1}));var O=[{label:"Annotations",options:E},{label:"Variables",options:f.map((function(e){return{label:e,value:e}}))}],k=[{label:"Annotations",options:E},{label:"Variables",options:[{isDisabled:!0,label:"Type to search",value:""}]}];return r.a.createElement("div",{className:t.root},r.a.createElement(Ft.a,{className:t.formControl},r.a.createElement(Gt.a,{htmlFor:"view"},"Embedding"),r.a.createElement($e.a,{className:t.select,input:r.a.createElement(Xe.a,{id:"view"}),onChange:this.handleViewChange,value:0===o.length?"":o[0],multiple:!1},g.map((function(e){return r.a.createElement(Ze.a,{key:e.name,value:e.name},r.a.createElement(Kt.a,{primary:e.name}))})))),r.a.createElement(Ft.a,{className:t.formControl},r.a.createElement(pa,{label:"Features",options:O,defaultOptions:k,value:b,onChange:this.props.handleFeatures,isMulti:!0})),r.a.createElement(Ft.a,{className:t.formControl},r.a.createElement(Gt.a,{htmlFor:"chart_size"},"Chart Size"),r.a.createElement($e.a,{className:t.select,input:r.a.createElement(Xe.a,{id:"chart_size"}),onChange:this.onEmbeddingChartSizeChange,value:a,multiple:!1},[{label:"Small",value:3},{label:"Medium",value:2},{label:"Large",value:1}].map((function(e){return r.a.createElement(Ze.a,{key:e.label,value:e.value},r.a.createElement(Kt.a,{primary:e.label}))})))),r.a.createElement(jt.a,{type:"number",step:"2",min:"0",max:"30",onKeyPress:this.onMarkerSizeKeyPress,onChange:this.onMarkerSizeChange,label:"Marker Size",className:t.formControl,value:c}),r.a.createElement(jt.a,{step:"0.1",type:"number",min:"0",max:"1",onKeyPress:this.onMarkerOpacityKeyPress,onChange:this.onMarkerOpacityChange,label:"Marker Opacity",className:t.formControl,value:u}),r.a.createElement(Ht.a,{control:r.a.createElement(Rt.a,{checked:p,value:"binPlot",onChange:this.handleBinValuesChange}),label:"Bin Plot"}),r.a.createElement(Ft.a,{className:t.formControl},r.a.createElement(Gt.a,{htmlFor:"color-scheme"},"Color Scheme"),r.a.createElement(ma,null)),p&&r.a.createElement(jt.a,{max:"1000",min:"20",step:"100",onKeyPress:this.onNumberOfBinsKeyPress,value:s,onChange:this.onNumberOfBinsChange,label:"# Bins Per Axis",className:t.formControl}),p&&r.a.createElement(Ft.a,{className:t.formControl},r.a.createElement(Gt.a,{htmlFor:"summary"},"Bin Summary"),r.a.createElement($e.a,{className:t.select,input:r.a.createElement(Xe.a,{id:"summary"}),onChange:this.onBinSummaryChange,value:h},[{value:"min",label:"Minimum"},{value:"max",label:"Maximum"},{value:"mean",label:"Mean"},{value:"sum",label:"Sum"}].map((function(e){return r.a.createElement(Ze.a,{key:e.value,value:e.value},r.a.createElement(Kt.a,{primary:e.label}))})))),r.a.createElement(Vt.a,null),r.a.createElement(Wt.a,{color:"textSecondary",display:"block",variant:"caption"},"Unselected Chart Properties"),r.a.createElement(jt.a,{type:"number",step:"2",min:"0",max:"30",onKeyPress:this.onUnselectedMarkerSizeKeyPress,onChange:this.onUnselectedMarkerSizeChange,label:"Unselected Marker Size",className:t.formControl,value:n}),r.a.createElement(jt.a,{step:"0.1",type:"number",min:"0",max:"1",onKeyPress:this.onUnselectedMarkerOpacityKeyPress,onChange:this.onUnselectedMarkerOpacityChange,label:"Unselected Marker Opacity",className:t.formControl,value:d}))}}]),t}(r.a.PureComponent),ga=tt()((function(e){return{root:{display:"flex",flexWrap:"wrap","flex-direction":"column"},formControl:{display:"block",margin:e.spacing(1),minWidth:200},select:{minWidth:200}}}))(Object(i.b)((function(e){return{selectedFeatures:e.features,selectedGroupBy:e.groupBy,selectedEmbeddings:e.embeddings,numberOfBins:e.numberOfBinsUI,markerSize:e.markerSizeUI,unselectedMarkerSize:e.unselectedMarkerSizeUI,markerOpacity:e.markerOpacityUI,embeddingChartSize:e.embeddingChartSize,unselectedMarkerOpacity:e.unselectedMarkerOpacityUI,binValues:e.binValues,binSummary:e.binSummary,dataset:e.dataset}}),(function(e,t){return{handleNumberOfBins:function(t){var a;e((a=t,function(e,t){if(t().numberOfBins!==a){var n=t().numberOfBins;e({type:W,payload:a}),e(Be({embedding:!0,clear:!0},(function(t){e({type:W,payload:n})})))}}))},handleNumberOfBinsUI:function(t){e({type:ue,payload:t})},handleMarkerSize:function(t){e({type:N,payload:t})},handleMarkerSizeUI:function(t){e({type:de,payload:t})},handleUnselectedMarkerSize:function(t){e({type:A,payload:t})},handleUnselectedMarkerSizeUI:function(t){e({type:D,payload:t})},handleMarkerOpacity:function(t){e({type:L,payload:t})},handleMarkerOpacityUI:function(t){e({type:pe,payload:t})},handleUnselectedMarkerOpacity:function(t){e({type:V,payload:t})},handleEmbeddingChartSize:function(t){e({type:R,payload:t})},handleUnselectedMarkerOpacityUI:function(t){e({type:he,payload:t})},handleBinSummary:function(t){var a;e((a=t,function(e,t){var n=t().binSummary;e({type:Y,payload:a}),e(Be({embedding:!0,clear:!0},(function(t){e({type:Y,payload:n})})))}))},handleBinValues:function(t){var a;e((a=t,function(e,t){var n=t().binValues;e({type:q,payload:a}),e(Be({embedding:!0,clear:!0},(function(t){e({type:q,payload:n})})))}))},handleViewName:function(t){e(_e(null==t?[]:[t]))},handleFeatures:function(t){e(Te(null==t?[]:t))}}}))(fa)),ya=5,va=1,ba=.1,Ea="mean",Oa=500,ka="Viridis",Ca={name:ka,value:P(ka)};var Sa=Object(o.c)({binSummary:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ea,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Y:return t.payload;case $:return Ea;case le:return null!=t.payload.binSummary?t.payload.binSummary:e;default:return e}},binValues:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case q:return t.payload;case $:return!1;case le:return null!=t.payload.binValues?t.payload.binValues:e;default:return e}},categoricalFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return t.payload;case le:return null!=t.payload.categoricalFilter?t.payload.categoricalFilter:e;default:return e}},dataset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case $:return t.payload;default:return e}},datasetChoices:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case re:return t.payload;case Z:return null==t.payload?[]:e;case U:return(e=e.concat([t.payload])).sort((function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1})),e;case I:case B:for(var a=-1,n=0;n<e.length;n++)if(e[n].id===t.payload.id){a=n;break}return-1!==a?(t.type===I?e[a]=t.payload:e.splice(a,1),e.slice()):e;default:return e}},dialog:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ee:return t.payload;default:return e}},dotPlotData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ie:return t.payload;case $:return null;default:return e}},email:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Z:return t.payload;default:return e}},embeddingChartSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R:return t.payload;case le:return null!=t.payload.embeddingChartSize?t.payload.embeddingChartSize:e;default:return e}},embeddingData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case oe:return t.payload;case R:var a=M.getEmbeddingChartSize(t.payload);return e.forEach((function(e){var t=Object.assign({},e.layout);t.width=a,t.height=a,e.layout=t})),e.slice();case N:return e.forEach((function(e){e.data.forEach((function(e){e.marker.size=t.payload})),e.data=e.data.slice()})),e.slice();case F:var n=t.payload.indices;return null!=t.payload.bins&&(n=M.convertBinsToPoints(e[0].data[0].bins,t.payload.bins)),e.forEach((function(e){e.data.forEach((function(e){e.selectedpoints=n})),e.data=e.data.slice()})),e.slice();case J:var r=Object(u.a)().domain([0,255]).range([0,1]);return e.forEach((function(e){if(e.continuous){var a=Object(d.a)(t.payload.value).domain(e.colorScale.domain());e.data.forEach((function(e){for(var t=[],n=0,l=e.values.length;n<l;n++){var i=Object(c.e)(a(e.values[n]));t.push([r(i.r),r(i.g),r(i.b)])}e.marker.color=t})),e.colorScale=a}e.data=e.data.slice()})),e.slice();case L:return e.forEach((function(e){e.data.forEach((function(e){e.marker.opacity=t.payload})),e.data=e.data.slice()})),e.slice();case V:return e.forEach((function(e){e.data.forEach((function(e){e.unselected.marker.opacity=t.payload})),e.data=e.data.slice()})),e.slice();case A:return e.forEach((function(e){e.data.forEach((function(e){e.unselected.marker.size=t.payload})),e.data=e.data.slice()})),e.slice();case $:return[];default:return e}},embeddings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case K:return t.payload;case $:return[];case le:return null!=t.payload.embeddings?t.payload.embeddings:e;default:return e}},features:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case H:return t.payload;case $:return[];case le:return t.payload.features||[];default:return e}},groupBy:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case G:return t.payload;case $:return[];case le:return t.payload.groupBy||[];default:return e}},interpolator:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ca,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case J:return t.payload;case le:return null!=t.payload.colorScheme?t.payload.colorScheme:e;default:return e}},loading:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case se:return t.payload;default:return e}},loadingApp:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ce:return t.payload;default:return e}},markerOpacity:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:va,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L:return t.payload;case $:return va;case le:return null!=t.payload.markerOpacity?t.payload.markerOpacity:e;default:return e}},markerOpacityUI:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L:case pe:return t.payload;case $:return va;case le:return null!=t.payload.markerOpacity?t.payload.markerOpacity:e;default:return e}},markerSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ya,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:return t.payload;case $:return ya;case le:return null!=t.payload.markerSize?t.payload.markerSize:e;default:return e}},markerSizeUI:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:case de:return t.payload;case $:return ya;case le:return null!=t.payload.markerSize?t.payload.markerSize:e;default:return e}},message:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case X:return t.payload;default:return e}},numberOfBins:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case W:return t.payload;case $:return Oa;case le:return null!=t.payload.numberOfBins?t.payload.numberOfBins:e;default:return e}},numberOfBinsUI:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case W:case ue:return t.payload;case $:return Oa;case le:return null!=t.payload.numberOfBins?t.payload.numberOfBins:e;default:return e}},plotConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;switch((arguments.length>1?arguments[1]:void 0).type){case $:return M.createPlotConfig();default:return e}},selectedValueCounts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case F:return t.payload;case $:return{};default:return e}},serverInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:return t.payload;default:return e}},unselectedMarkerOpacity:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ba,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case V:return t.payload;case $:return ba;case le:return null!=t.payload.unselectedMarkerOpacity?t.payload.unselectedMarkerOpacity:e;default:return e}},unselectedMarkerOpacityUI:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ba,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case V:case he:return t.payload;case $:return ba;case le:return null!=t.payload.unselectedMarkerOpacity?t.payload.unselectedMarkerOpacity:e;default:return e}},unselectedMarkerSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ya,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A:return t.payload;case $:return ya;case le:return null!=t.payload.unselectedMarkerSize?t.payload.unselectedMarkerSize:e;default:return e}},unselectedMarkerSizeUI:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A:case D:return t.payload;case $:return ya;case le:return null!=t.payload.unselectedMarkerSize?t.payload.unselectedMarkerSize:e;default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Q:return t.payload;default:return e}}}),wa=Object(k.a)(","),ja=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(g.a)(this,Object(y.a)(t).call(this,e))).handleUserMenuClose=function(){a.setState({userMenuOpen:!1})},a.handleMessageClose=function(){a.props.setMessage(null)},a.handleUserMenuOpen=function(e){a.setState({userMenuOpen:!0,userMenuAnchorEl:e.currentTarget})},a.handleLinkMenuClose=function(e){a.setState({linkMenuOpen:!1,linkMenuAnchorEl:null})},a.copyLink=function(){a.linkRef.current.focus(),a.linkRef.current.select(),document.execCommand("copy"),a.props.setMessage("Link copied")},a.handleSelectedCellsClick=function(e){e.preventDefault(),a.props.downloadSelectedIds()},a.handleLinkMenuOpen=function(e){var t=window.location.protocol+"//"+window.location.host,n={dataset:a.props.dataset.id,embedding:a.props.embedding};a.props.features.length>0&&(n.features=a.props.features),a.props.groupBy.length>0&&(n.groupBy=a.props.groupBy);var r=a.props.categoricalFilter;Object.keys(r).length>0&&(n.categoricalFilter=a.props.categoricalFilter),a.props.markerSize!==ya&&(n.markerSize=a.props.markerSize),a.props.markerOpacity!==va&&(n.markerOpacity=a.props.markerOpacity),a.props.binValues&&(n.binValues=!0,a.props.binSummary!==Ea&&(n.binSummary=a.props.binSummary),a.props.numberOfBins!==Oa&&(n.numberOfBins=a.props.numberOfBins)),a.props.view3d&&(n["3d"]=!0),a.props.interpolator.name!==ka&&(n.colorScheme=a.props.interpolator.name),t+="?q="+JSON.stringify(n),a.setState({linkMenuOpen:!0,linkMenuAnchorEl:e.currentTarget,linkText:t})},a.handleLogout=function(){a.setState({userMenuOpen:!1}),a.props.handleLogout()},a.handleDataset=function(e){"importDataset"===e.target.value?a.props.handleDialog(ae):a.props.handleDataset(e.target.value)},a.handleSettings=function(e){a.props.handleDialog(te)},a.handleDelete=function(e){a.props.handleDialog(ne)},a.state={userMenuOpen:!1,linkMenuOpen:!1,userMenuAnchorEl:null,linkMenuAnchorEl:null,linkText:null},a.linkRef=r.a.createRef(),a}return Object(v.a)(t,e),Object(O.a)(t,[{key:"componentDidUpdate",value:function(e,t,a){var n=this;this.state.linkMenuOpen&&window.requestAnimationFrame((function(){n.linkRef.current.focus(),n.linkRef.current.select()}))}},{key:"render",value:function(){var e=this.props.classes,t=null!=this.props.dataset&&this.props.dataset.nObs>0&&!isNaN(this.props.selectedValueCounts.count),a=!t&&null!=this.props.dataset&&!(this.props.selectedValueCounts.count>0)&&this.props.dataset.nObs>0;return r.a.createElement("div",{className:e.root},(this.props.dialog===te||this.props.dialog===ae)&&r.a.createElement(Mt,null),this.props.dialog===ne&&r.a.createElement(vt,null),r.a.createElement(He.a,{position:"fixed",color:"default",className:e.appBar},r.a.createElement(at.a,{variant:"dense"},r.a.createElement("div",null,r.a.createElement(st.a,{style:{verticalAlign:"bottom"},fontSize:"large"}),r.a.createElement("h3",{style:{display:"inline",marginRight:20}},"Cirro"),this.props.loadingApp&&r.a.createElement("span",null,"Loading..."),null!=this.props.email&&r.a.createElement($e.a,{disableUnderline:!0,displayEmpty:!0,value:null==this.props.dataset?"":this.props.dataset.id,onChange:this.handleDataset,inputProps:{name:"dataset",id:"dataset-id"}}," ",this.props.datasetChoices.length>0&&r.a.createElement(Ze.a,{key:"",value:"",disabled:!0},"Choose a dataset"),this.props.datasetChoices.map((function(e){return r.a.createElement(Ze.a,{key:e.id,value:e.id},e.name)})),this.props.user.importer&&this.props.datasetChoices.length>0&&r.a.createElement("hr",null),this.props.user.importer&&r.a.createElement(Ze.a,{key:"importDataset",value:"importDataset"},"Import...")),r.a.createElement("div",{style:{display:"inline-block",marginLeft:"10px"}},t&&r.a.createElement(Je.a,{title:"Download selected ids",href:"#",onClick:this.handleSelectedCellsClick},wa(this.props.selectedValueCounts.count)),t&&" / "+wa(this.props.dataset.nObs)+" cells",a&&wa(this.props.dataset.nObs)+" cells")),r.a.createElement("div",{style:{marginLeft:"auto"}},null!=this.props.dataset&&r.a.createElement(Le.a,{title:"Link"},r.a.createElement(Re.a,{"aria-owns":this.state.linkMenuOpen?"link-popper":void 0,"aria-haspopup":"true",onClick:this.handleLinkMenuOpen,"aria-label":"Link"},r.a.createElement(pt.a,null))),null!==this.props.dataset&&this.props.dataset.owner&&r.a.createElement(Le.a,{title:"Edit"},r.a.createElement(Re.a,{onClick:this.handleSettings,"aria-label":"Edit"},r.a.createElement(mt.a,null))),null!==this.props.dataset&&this.props.dataset.owner&&r.a.createElement(Le.a,{title:"Delete"},r.a.createElement(Re.a,{onClick:this.handleDelete,"aria-label":"Delete"},r.a.createElement(ut.a,null))),null!=this.props.dataset&&r.a.createElement(Qe.a,{id:"link-popper",open:this.state.linkMenuOpen,anchorEl:this.state.linkMenuAnchorEl,onClose:this.handleLinkMenuClose,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},r.a.createElement("div",{style:{padding:10}},r.a.createElement("h4",null,"Copy link to share your current view"),r.a.createElement(Ge.a,{size:"small",variant:"outlined",onClick:this.copyLink},"Copy")," ",r.a.createElement(Xe.a,{autoFocus:!0,inputRef:this.linkRef,readOnly:!0,value:this.state.linkText}))),null!=this.props.email&&r.a.createElement(Le.a,{title:this.props.email},r.a.createElement(Re.a,{style:{marginLeft:50},"aria-label":"Menu","aria-haspopup":"true",onClick:this.handleUserMenuOpen},r.a.createElement(rt.a,null))),null!=this.props.email&&r.a.createElement(Ve.a,{id:"menu-user",anchorEl:this.state.userMenuAnchorEl,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:this.state.userMenuOpen,onClose:this.handleUserMenuClose},r.a.createElement(Ze.a,{onClick:this.handleLogout},"Sign Out")),!this.props.loadingApp&&null==this.props.email&&r.a.createElement(Ge.a,{style:{whiteSpace:"nowrap"},variant:"outlined",color:"primary",onClick:this.props.handleLogin},"Sign In")))),r.a.createElement(Ye.a,{className:e.drawer,variant:"permanent",classes:{paper:e.drawerPaper},anchor:"left"},null!=this.props.dataset&&r.a.createElement(ga,{key:this.props.dataset.id})),r.a.createElement("div",null),r.a.createElement("main",{className:e.content},null!=this.props.dataset&&r.a.createElement(Lt,null),null!=this.props.dataset&&r.a.createElement(wt,null)),this.props.loading&&r.a.createElement(We.a,{"aria-labelledby":"loading-dialog-title",open:!0},r.a.createElement(qe.a,{id:"loading-dialog-title"},r.a.createElement(Ke.a,{size:20})," Loading...")),null!=this.props.message&&r.a.createElement(Fe.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},ContentProps:{"aria-describedby":"message-id"},onClose:this.handleMessageClose,open:!0,autoHideDuration:6e3,action:[r.a.createElement(Re.a,{key:"close","aria-label":"Close",color:"inherit",onClick:this.handleMessageClose},r.a.createElement(it.a,null))],message:r.a.createElement("span",{id:"message-id"},this.props.message instanceof Error?this.props.message.message:this.props.message)}))}}]),t}(n.PureComponent),Pa=tt()((function(e){return{root:{display:"flex"},appBar:{width:"calc(100% - ".concat(240,"px)"),marginLeft:240},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},toolbar:e.mixins.toolbar,content:{flexGrow:1,backgroundColor:e.palette.background.default,paddingTop:e.spacing(6.5),paddingLeft:e.spacing(1)}}}))(Object(i.b)((function(e){return{binSummary:e.binSummary,binValues:e.binValues,categoricalFilter:e.categoricalFilter,dataset:e.dataset,datasetChoices:e.datasetChoices,dialog:e.dialog,email:e.email,embedding:e.embedding,features:e.features,groupBy:e.groupBy,interpolator:e.interpolator,loading:e.loading,loadingApp:e.loadingApp,markerOpacity:e.markerOpacity,markerSize:e.markerSize,message:e.message,numberOfBins:e.numberOfBins,selectedValueCounts:e.selectedValueCounts,user:e.user,view3d:e.view3d}}),(function(e){return{handleLogin:function(){e((function(e,t){window.gapi.auth2.getAuthInstance().signIn().then((function(t){e(Ce())}))}))},handleLogout:function(){e(ye())},handleDataset:function(t){e(Ue(t))},handleDialog:function(t){e(Me(t))},setMessage:function(t){e(Pe(t))},downloadSelectedIds:function(){e((function(e,t){e(xe(!0));var a=ve(t());fetch(x+"/selected_ids",{body:JSON.stringify(a),method:"POST",headers:{Authorization:"Bearer "+Se()}}).then((function(e){return e.json()})).then((function(e){var t=new Blob([e.join("\n")],{type:"text/plain;charset=utf-8"});Object(m.saveAs)(t,"selection.txt")})).finally((function(){e(xe(!1))}))}))}}}))(ja)),Ma=a(231),xa=a(127),za=Object(xa.a)({palette:{type:"light"}}),Aa=Object(o.d)(Sa,Object(o.a)(s.a));Aa.dispatch((function(e,t){fetch(x+"/server").then((function(e){return e.json()})).then((function(t){if(""==t.clientId)e(ze(!1)),e(De("")),e(Ne()).then((function(){e(ke()),e((function(e,t){null==t().dataset&&1===t().datasetChoices.length&&e(Ue(t().datasetChoices[0].id))}))}));else{var a=document.createElement("script");a.type="text/javascript",a.src="https://apis.google.com/js/api.js",e({type:T,payload:t}),a.onload=function(a){window.gapi.load("client:auth2",(function(){window.gapi.client.init({clientId:t.clientId,discoveryDocs:[],scope:z.join(" ")}).then((function(){e(ze(!1)),e(Ce(!0))}))}))},document.getElementsByTagName("head")[0].appendChild(a)}}))})),Object(l.render)(r.a.createElement(i.a,{store:Aa},r.a.createElement(Ma.a,{theme:za},r.a.createElement(Pa,null))),document.getElementById("root"))}},[[151,1,2]]]);
//# sourceMappingURL=main.eaba8606.chunk.js.map